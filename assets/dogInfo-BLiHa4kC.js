import{p as ue,g as ie,ah as Ge,x as z,t as j,ai as Me,y as $e,u as de,a,F as L,M as G,aj as Be,ak as He,al as pe,am as Ee,J as Ne,an as Ue,ao as re,ap as ze,aq as Le,ar as Oe,as as je,C as b,v as qe,N as Ke,G as Je,E as Z,H as We,at as Ye,au as Ze,av as be,aw as Qe,ax as Xe,ay as ea,az as aa,af as ce,aA as ta,A as la,D as oa,T as na,o as q,W as Q,w as n,P as ne,a0 as A,aB as sa,$ as ra,U as d,aC as me,aD as Ve,a1 as ye,aE as ua,aF as se,a2 as xe,ag as ae,Y as ve,aG as ia,c as ke,b as Pe,Z as he,aH as da,aI as ca,aJ as ma,V as va,aK as we,aL as fa,r as ga}from"./index-BeUQFjP5.js";import{c as pa,a as fe,b as Se,d as ba,e as Va,u as ya,f as K,V as xa}from"./vee-validate.esm-KevpO-rl.js";import{b as Ce}from"./route-block-B_A1xBdJ.js";import{a as X,V as ee}from"./VRow-uWmG4DVT.js";import{V as ka}from"./VCheckbox-BTs5MBbW.js";import{m as Pa,V as ge,a as ha,b as wa}from"./VCheckboxBtn-DoIMKRBf.js";import{V as _e}from"./VDivider-CEtPk7m6.js";import{m as Sa,a as Ca,b as Ia,c as Ta,d as Da,e as Fa,f as Ra,u as Ba,p as Na,g as Ua,h as _a,i as Aa,j as Ga,k as Ma,l as $a,V as Ie,n as Te,o as De,q as Fe}from"./VDataTable-DRjJVpoy.js";import{V as Ha,a as Ea}from"./VList-DHIwkay0.js";import{V as za}from"./VContainer-CctDpTPI.js";import"./VPagination-CMQexviq.js";const La=ue({itemsLength:{type:[Number,String],required:!0},...Sa(),...Ca(),...Ia()},"VDataTableServer"),Oa=ie()({name:"VDataTableServer",props:La(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,M){let{attrs:w,slots:o}=M;const{groupBy:v}=Ta(e),{sortBy:c,multiSort:i,mustSort:$}=Da(e),{page:I,itemsPerPage:_}=Fa(e),{disableSort:O}=Ge(e),F=z(()=>parseInt(e.itemsLength,10)),{columns:T,headers:y}=Ra(e,{groupBy:v,showSelect:j(e,"showSelect"),showExpand:j(e,"showExpand")}),{items:k}=Ba(e,T),{toggleSort:P}=Na({sortBy:c,multiSort:i,mustSort:$,page:I}),{opened:R,isGroupOpen:C,toggleGroup:H,extractRows:E}=Ua({groupBy:v,sortBy:c,disableSort:O}),{pageCount:B,setItemsPerPage:J}=_a({page:I,itemsPerPage:_,itemsLength:F}),{flatItems:D}=Aa(k,v,R),{isSelected:N,select:U,selectAll:S,toggleSelect:h,someSelected:u,allSelected:p}=Ga(e,{allItems:k,currentPage:k}),{isExpanded:f,toggleExpand:V}=Ma(e),x=z(()=>E(k.value));$a({page:I,itemsPerPage:_,sortBy:c,groupBy:v,search:j(e,"search")}),Me("v-data-table",{toggleSort:P,sortBy:c}),$e({VDataTableRows:{hideNoData:j(e,"hideNoData"),noDataText:j(e,"noDataText"),loading:j(e,"loading"),loadingText:j(e,"loadingText")}});const s=z(()=>({page:I.value,itemsPerPage:_.value,sortBy:c.value,pageCount:B.value,toggleSort:P,setItemsPerPage:J,someSelected:u.value,allSelected:p.value,isSelected:N,select:U,selectAll:S,toggleSelect:h,isExpanded:f,toggleExpand:V,isGroupOpen:C,toggleGroup:H,items:x.value.map(l=>l.raw),internalItems:x.value,groupedItems:D.value,columns:T.value,headers:y.value}));de(()=>{const l=Ie.filterProps(e),g=Te.filterProps(e),t=De.filterProps(e),r=Fe.filterProps(e);return a(Fe,G({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},r),{top:()=>{var m;return(m=o.top)==null?void 0:m.call(o,s.value)},default:()=>{var m,te,le,oe,W,Y;return o.default?o.default(s.value):a(L,null,[(m=o.colgroup)==null?void 0:m.call(o,s.value),!e.hideDefaultHeader&&a("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[a(Te,G(g,{sticky:e.fixedHeader}),o)]),(te=o.thead)==null?void 0:te.call(o,s.value),!e.hideDefaultBody&&a("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(le=o["body.prepend"])==null?void 0:le.call(o,s.value),o.body?o.body(s.value):a(De,G(w,t,{items:D.value}),o),(oe=o["body.append"])==null?void 0:oe.call(o,s.value)]),(W=o.tbody)==null?void 0:W.call(o,s.value),(Y=o.tfoot)==null?void 0:Y.call(o,s.value)])},bottom:()=>o.bottom?o.bottom(s.value):!e.hideDefaultFooter&&a(L,null,[a(_e,null,null),a(Ie,l,{prepend:o["footer.prepend"]})])})})}}),ja=ue({...Pa({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Re=ie()({name:"VRadio",props:ja(),setup(e,M){let{slots:w}=M;return de(()=>{const o=ge.filterProps(e);return a(ge,G(o,{class:["v-radio",e.class],style:e.style,type:"radio"}),w)}),{}}}),qa=ue({height:{type:[Number,String],default:"auto"},...Be(),...He(ha(),["multiple"]),trueIcon:{type:pe,default:"$radioOn"},falseIcon:{type:pe,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Ka=ie()({name:"VRadioGroup",inheritAttrs:!1,props:qa(),emits:{"update:modelValue":e=>!0},setup(e,M){let{attrs:w,slots:o}=M;const v=Ee(),c=z(()=>e.id||`radio-group-${v}`),i=Ne(e,"modelValue");return de(()=>{const[$,I]=Ue(w),_=re.filterProps(e),O=ge.filterProps(e),F=o.label?o.label({label:e.label,props:{for:c.value}}):e.label;return a(re,G({class:["v-radio-group",e.class],style:e.style},$,_,{modelValue:i.value,"onUpdate:modelValue":T=>i.value=T,id:c.value}),{...o,default:T=>{let{id:y,messagesId:k,isDisabled:P,isReadonly:R}=T;return a(L,null,[F&&a(ze,{id:y.value},{default:()=>[F]}),a(wa,G(O,{id:y.value,"aria-describedby":k.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:P.value,readonly:R.value,"aria-labelledby":F?y.value:void 0,multiple:!1},I,{modelValue:i.value,"onUpdate:modelValue":C=>i.value=C}),o)])}})}),{}}}),Ja=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Be(),...Le()},"VTextarea"),Wa=ie()({name:"VTextarea",directives:{Intersect:Oe},inheritAttrs:!1,props:Ja(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,M){let{attrs:w,emit:o,slots:v}=M;const c=Ne(e,"modelValue"),{isFocused:i,focus:$,blur:I}=je(e),_=z(()=>typeof e.counterValue=="function"?e.counterValue(c.value):(c.value||"").toString().length),O=z(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function F(u,p){var f,V;!e.autofocus||!u||(V=(f=p[0].target)==null?void 0:f.focus)==null||V.call(f)}const T=b(),y=b(),k=qe(""),P=b(),R=z(()=>e.persistentPlaceholder||i.value||e.active);function C(){var u;P.value!==document.activeElement&&((u=P.value)==null||u.focus()),i.value||$()}function H(u){C(),o("click:control",u)}function E(u){o("mousedown:control",u)}function B(u){u.stopPropagation(),C(),ce(()=>{c.value="",ta(e["onClick:clear"],u)})}function J(u){var f;const p=u.target;if(c.value=p.value,(f=e.modelModifiers)!=null&&f.trim){const V=[p.selectionStart,p.selectionEnd];ce(()=>{p.selectionStart=V[0],p.selectionEnd=V[1]})}}const D=b(),N=b(+e.rows),U=z(()=>["plain","underlined"].includes(e.variant));Ke(()=>{e.autoGrow||(N.value=+e.rows)});function S(){e.autoGrow&&ce(()=>{if(!D.value||!y.value)return;const u=getComputedStyle(D.value),p=getComputedStyle(y.value.$el),f=parseFloat(u.getPropertyValue("--v-field-padding-top"))+parseFloat(u.getPropertyValue("--v-input-padding-top"))+parseFloat(u.getPropertyValue("--v-field-padding-bottom")),V=D.value.scrollHeight,x=parseFloat(u.lineHeight),s=Math.max(parseFloat(e.rows)*x+f,parseFloat(p.getPropertyValue("--v-input-control-height"))),l=parseFloat(e.maxRows)*x+f||1/0,g=oa(V??0,s,l);N.value=Math.floor((g-f)/x),k.value=la(g)})}Je(S),Z(c,S),Z(()=>e.rows,S),Z(()=>e.maxRows,S),Z(()=>e.density,S);let h;return Z(D,u=>{u?(h=new ResizeObserver(S),h.observe(D.value)):h==null||h.disconnect()}),We(()=>{h==null||h.disconnect()}),de(()=>{const u=!!(v.counter||e.counter||e.counterValue),p=!!(u||v.details),[f,V]=Ue(w),{modelValue:x,...s}=re.filterProps(e),l=Ye(e);return a(re,G({ref:T,modelValue:c.value,"onUpdate:modelValue":g=>c.value=g,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":U.value},e.class],style:e.style},f,s,{centerAffix:N.value===1&&!U.value,focused:i.value}),{...v,default:g=>{let{id:t,isDisabled:r,isDirty:m,isReadonly:te,isValid:le}=g;return a(Ze,G({ref:y,style:{"--v-textarea-control-height":k.value},onClick:H,onMousedown:E,"onClick:clear":B,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},l,{id:t.value,active:R.value||m.value,centerAffix:N.value===1&&!U.value,dirty:m.value||e.dirty,disabled:r.value,focused:i.value,error:le.value===!1}),{...v,default:oe=>{let{props:{class:W,...Y}}=oe;return a(L,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),be(a("textarea",G({ref:P,class:W,value:c.value,onInput:J,autofocus:e.autofocus,readonly:te.value,disabled:r.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:C,onBlur:I},Y,V),null),[[Qe("intersect"),{handler:F},null,{once:!0}]]),e.autoGrow&&be(a("textarea",{class:[W,"v-textarea__sizer"],id:`${Y.id}-sizer`,"onUpdate:modelValue":Ae=>c.value=Ae,ref:D,readonly:!0,"aria-hidden":"true"},null),[[Xe,c.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:p?g=>{var t;return a(L,null,[(t=v.details)==null?void 0:t.call(v,g),u&&a(L,null,[a("span",null,null),a(ea,{active:e.persistentCounter||i.value,value:_.value,max:O.value,disabled:e.disabled},v.counter)])])}:void 0})}),aa({},T,y,P)}}),Ya=ae("h1",null,"狗狗資訊管理",-1),Za=ae("p",null,"狗狗大頭照：",-1),Qa=ae("h3",null,"狗狗個人資訊",-1),Xa={__name:"dogInfo",setup(e){const{backApi:M,apiAuth:w}=fa(),o=na(),v=b(null),c=b(["10:00～12:00","13:00～15:00","15:00～17:00","19:00～21:00"]),i=b({open:!1,id:""}),$=s=>{s?(i.value.id=s._id,k.value.value=s.dogName,P.value.value=s.age,y.value.value=s.price,C.value.value=s.booking,H.value.value=s.bookingTime,R.value.value=s.feature,E.value.value=s.sell):i.value.id="",i.value.open=!0},I=()=>{i.value.open=!1,T(),v.value.deleteFileRecord()},_=pa({dogName:fe().required("狗狗名字必填"),age:Se().required("狗狗年齡必填").min(0,"年齡不能小於 0"),price:Se().required("預約價格必填").typeError("商品價格格式錯誤").min(0,"商品價格不能小於 0"),booking:fe().required("預約狀態必填"),bookingTime:ba(),feature:fe().required("狗狗性格、特徵必填"),sell:Va()}),{handleSubmit:O,isSubmitting:F,resetForm:T}=ya({validationSchema:_,initialValues:{dogName:"",age:0,price:0,booking:"",bookingTime:[],feature:"",sell:!0}}),y=K("price"),k=K("dogName"),P=K("age"),R=K("feature"),C=K("booking"),H=K("bookingTime"),E=K("sell"),B=b([]),J=b([]),D=O(async s=>{var l,g,t;if(!((l=B.value[0])!=null&&l.error)&&!(i.value.id.length===0&&B.value.length<1))try{const r=new FormData;r.append("dogName",s.dogName),r.append("age",s.age),r.append("price",s.price),r.append("booking",s.booking),r.append("bookingTime",s.bookingTime),r.append("feature",s.feature),r.append("sell",s.sell),B.value.length>0&&r.append("image",B.value[0].file),i.value.id===""?await w.post("/dogs",r):await w.patch("/dogs/"+i.value.id,r),o({text:i.value.id===""?"新增成功":"編輯成功",snackbarProps:{color:"green"}}),I(),x(!0)}catch(r){console.log(r),o({text:((t=(g=r==null?void 0:r.response)==null?void 0:g.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),N=b(10),U=b([{key:"createdAt",order:"desc"}]),S=b(1),h=b([]),u=[{title:"名字",align:"center",sortable:!0,key:"dogName"},{title:"大頭照",align:"center",sortable:!1,key:"image"},{title:"年齡",align:"center",sortable:!0,key:"age"},{title:"價格",align:"center",sortable:!0,key:"price"},{title:"預約狀態",align:"center",sortable:!0,key:"booking"},{title:"預約時段",align:"center",sortable:!0,key:"bookingTime"},{title:"性格、特徵",align:"center",sortable:!1,key:"feature"},{title:"點檯",align:"center",sortable:!0,key:"counter"},{title:"上下架",align:"center",sortable:!1,key:"sell"},{title:"編輯",align:"center",sortable:!1,key:"edit"}],p=b(!0),f=b(0),V=b(""),x=async s=>{var l,g,t,r;s&&(S.value=1),p.value=!0;try{const{data:m}=await w.get("/dogs/all",{params:{page:S.value,itemsPerPage:N.value,sortBy:((l=U.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((g=U.value[0])==null?void 0:g.order)||"desc",search:V.value}});h.value.splice(0,h.value.length,...m.result.data),f.value=m.result.total}catch(m){console.log(m),o({text:((r=(t=m==null?void 0:m.response)==null?void 0:t.data)==null?void 0:r.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};return x(),(s,l)=>{const g=ga("vue-file-agent");return q(),Q(za,{fluid:""},{default:n(()=>[a(ee,{class:"text-center"},{default:n(()=>[a(X,null,{default:n(()=>[Ya]),_:1})]),_:1}),a(ee,{class:"text-center"},{default:n(()=>[a(X,null,{default:n(()=>[a(ne,{color:"green",onClick:l[0]||(l[0]=t=>$(null))},{default:n(()=>[A("新增夥伴資訊")]),_:1})]),_:1}),a(sa,{modelValue:i.value.open,"onUpdate:modelValue":l[10]||(l[10]=t=>i.value.open=t),persistent:"",width:"500"},{default:n(()=>[a(xa,{onSubmit:ra(d(D),["prevent"])},{default:n(()=>[a(me,null,{default:n(()=>[a(Ve,null,{default:n(()=>[A(ye(i.value.id?"編輯狗狗資訊":"新增狗狗資訊"),1)]),_:1}),a(ua,{class:"pb-0"},{default:n(()=>[Za,a(g,{modelValue:B.value,"onUpdate:modelValue":l[1]||(l[1]=t=>B.value=t),"raw-model-value":J.value,"onUpdate:rawModelValue":l[2]||(l[2]=t=>J.value=t),accept:"image/jpeg,image/jpg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:v},null,8,["modelValue","raw-model-value"]),a(ee,{class:"mt-4"},{default:n(()=>[a(X,null,{default:n(()=>[a(se,{label:"狗狗名字",modelValue:d(k).value.value,"onUpdate:modelValue":l[3]||(l[3]=t=>d(k).value.value=t),"error-messages":d(k).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(X,null,{default:n(()=>[a(se,{label:"年齡",type:"number",min:"0",modelValue:d(P).value.value,"onUpdate:modelValue":l[4]||(l[4]=t=>d(P).value.value=t),"error-messages":d(P).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),a(ee,{class:"d-flex ma-0"},{default:n(()=>[a(X,{class:"d-flex align-self-center ps-0"},{default:n(()=>[a(se,{label:"預約價格",type:"number",min:"0",modelValue:d(y).value.value,"onUpdate:modelValue":l[5]||(l[5]=t=>d(y).value.value=t),"error-messages":d(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(ka,{label:"上架",class:"d-flex justify-center",modelValue:d(E).value.value,"onUpdate:modelValue":l[6]||(l[6]=t=>d(E).value.value=t),"error-messages":d(E).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(Ka,{class:"d-flex",inline:"","hide-spin-buttons":"",modelValue:d(C).value.value,"onUpdate:modelValue":l[7]||(l[7]=t=>d(C).value.value=t)},{default:n(()=>[a(xe,{class:"d-flex align-center"},{default:n(()=>[ae("p",null,[a(ve,{class:"me-1"},{default:n(()=>[A("mdi-invoice-clock")]),_:1}),A("預約狀態：")])]),_:1}),a(Re,{label:"可預約",value:"可預約"}),a(Re,{label:"預約已滿",value:"預約已滿"})]),_:1},8,["modelValue"]),d(C).value.value==="可預約"?(q(),Q(xe,{key:0,class:"mt-4"},{default:n(()=>[ae("p",null,[a(ve,{class:"me-1"},{default:n(()=>[A("mdi-clock")]),_:1}),A("可預約時段：")]),a(ia,{"selected-class":"bg-amber-darken-4",multiple:"",modelValue:d(H).value.value,"onUpdate:modelValue":l[8]||(l[8]=t=>d(H).value.value=t),"error-messages":d(H).errorMessage.value},{default:n(()=>[(q(!0),ke(L,null,Pe(c.value,t=>(q(),Q(we,{key:t,text:t,value:t},null,8,["text","value"]))),128))]),_:1},8,["modelValue","error-messages"])]),_:1})):he("",!0),a(Wa,{label:"狗狗的性格、特徵",class:"mt-6",modelValue:d(R).value.value,"onUpdate:modelValue":l[9]||(l[9]=t=>d(R).value.value=t),"error-messages":d(R).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(da,{class:"justify-center mb-5"},{default:n(()=>[a(ne,{class:"bg-red me-5",loading:d(F),onClick:I},{default:n(()=>[A("取消")]),_:1},8,["loading"]),a(ne,{class:"bg-green",type:"submit",loading:d(F)},{default:n(()=>[A("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1}),a(ee,{class:"justify-center mt-10",width:"1500"},{default:n(()=>[a(me,{flat:""},{default:n(()=>[a(Ve,{class:"d-flex align-center pe-2"},{default:n(()=>[Qa,a(ca),a(se,{label:"搜尋",modelValue:V.value,"onUpdate:modelValue":l[11]||(l[11]=t=>V.value=t),density:"comfortable","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"","onClick:prependInner":l[12]||(l[12]=t=>x(!0)),onKeydown:l[13]||(l[13]=ma(t=>x(!0),["enter"]))},null,8,["modelValue"])]),_:1}),a(_e),a(Oa,{class:"text-center","items-per-page":N.value,"onUpdate:itemsPerPage":[l[14]||(l[14]=t=>N.value=t),l[17]||(l[17]=t=>x(!1))],"sort-by":U.value,"onUpdate:sortBy":[l[15]||(l[15]=t=>U.value=t),l[18]||(l[18]=t=>x(!1))],page:S.value,"onUpdate:page":[l[16]||(l[16]=t=>S.value=t),l[19]||(l[19]=t=>x(!1))],items:h.value,headers:u,"items-length":f.value,loading:p.value,search:V.value},{"item.image":n(({value:t})=>[a(me,{class:"my-2",elevation:"2",rounded:""},{default:n(()=>[a(va,{src:t,width:"200",height:"150",cover:""},null,8,["src"])]),_:2},1024)]),"item.booking":n(({value:t})=>[a(we,{text:t,color:t==="可預約"?"green":"red",size:"small",label:""},null,8,["text","color"])]),"item.bookingTime":n(({value:t})=>[a(Ha,null,{default:n(()=>[(q(!0),ke(L,null,Pe(t.join(" ").split(",").sort((r,m)=>parseInt(r)-parseInt(m)),(r,m)=>(q(),Q(Ea,{key:m},{default:n(()=>[A(ye(r),1)]),_:2},1024))),128))]),_:2},1024)]),"item.sell":n(({value:t})=>[t?(q(),Q(ve,{key:0,icon:"mdi-check"})):he("",!0)]),"item.edit":n(({item:t})=>[a(ne,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:r=>$(t)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","items-length","loading","search"])]),_:1})]),_:1})]),_:1})}}};typeof Ce=="function"&&Ce(Xa);export{Xa as default};
