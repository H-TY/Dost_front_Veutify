import{p as L,ar as le,s as E,J as b,t as Z,e as t,l as U,aN as Ne,A as Ie,aR as be,L as ie,aS as Ae,aT as Ye,r as O,aU as Te,aV as te,I as K,w as H,a2 as Y,S as ee,aW as Ve,X as _e,W as R,M as Pe,aX as Be,P as Re,al as Ue,aq as ae,aY as Oe,aZ as We,a_ as ue,F as se,a$ as $e,b0 as ne,_ as je,a as Fe,i as qe,o as X,k as oe,f as y,d as de,h as ce,j as S,aH as He,V as J,a1 as Le,a5 as q,a4 as ve,a3 as re,b1 as Ee,b as ze,aQ as Xe,a6 as Je,a7 as Qe,a8 as xe}from"./index-C8Gimdpc.js";import{_ as Ze}from"./dogsCard-Zsc2Ggzx.js";import{c as Ge,a as Q,d as Ke,b as ea,u as aa,f as j,V as me}from"./vee-validate.esm-B1pgnu0H.js";import{P as ta,N as la,S as na,a as oa}from"./pagination-COWLy1L7.js";import{V as fe}from"./VCol-DOSgLDbZ.js";import{V as ra}from"./VDivider-CkgvFL66.js";import{a as sa}from"./VList-C9Bb4WUH.js";import{V as ia}from"./VRow-C57ivwHW.js";import{V as ua}from"./VContainer-BytFLAEg.js";import{V as da}from"./VCheckbox-CtxC78rH.js";import"./VCheckboxBtn-B9FA3Eqr.js";const De=L({active:{type:[String,Array],default:void 0},disabled:{type:[Boolean,String,Array],default:!1},nextIcon:{type:le,default:"$next"},prevIcon:{type:le,default:"$prev"},modeIcon:{type:le,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),ke=E()({name:"VDatePickerControls",props:De(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(e,P){let{emit:V}=P;const u=b(()=>Array.isArray(e.disabled)?e.disabled.includes("text"):!!e.disabled),a=b(()=>Array.isArray(e.disabled)?e.disabled.includes("mode"):!!e.disabled),m=b(()=>Array.isArray(e.disabled)?e.disabled.includes("prev"):!!e.disabled),r=b(()=>Array.isArray(e.disabled)?e.disabled.includes("next"):!!e.disabled);function c(){V("click:prev")}function s(){V("click:next")}function l(){V("click:year")}function n(){V("click:month")}return Z(()=>t("div",{class:["v-date-picker-controls"]},[t(U,{class:"v-date-picker-controls__month-btn",disabled:u.value,text:e.text,variant:"text",rounded:!0,onClick:n},null),t(U,{key:"mode-btn",class:"v-date-picker-controls__mode-btn",disabled:a.value,density:"comfortable",icon:e.modeIcon,variant:"text",onClick:l},null),t(Ne,{key:"mode-spacer"},null),t("div",{key:"month-buttons",class:"v-date-picker-controls__month"},[t(U,{disabled:m.value,icon:e.prevIcon,variant:"text",onClick:c},null),t(U,{disabled:r.value,icon:e.nextIcon,variant:"text",onClick:s},null)])])),{}}}),ca=L({appendIcon:String,color:String,header:String,transition:String,onClick:Ae()},"VDatePickerHeader"),he=E()({name:"VDatePickerHeader",props:ca(),emits:{click:()=>!0,"click:append":()=>!0},setup(e,P){let{emit:V,slots:u}=P;const{backgroundColorClasses:a,backgroundColorStyles:m}=Ie(e,"color");function r(){V("click")}function c(){V("click:append")}return Z(()=>{const s=!!(u.default||e.header),l=!!(u.append||e.appendIcon);return t("div",{class:["v-date-picker-header",{"v-date-picker-header--clickable":!!e.onClick},a.value],style:m.value,onClick:r},[u.prepend&&t("div",{key:"prepend",class:"v-date-picker-header__prepend"},[u.prepend()]),s&&t(be,{key:"content",name:e.transition},{default:()=>{var n;return[t("div",{key:e.header,class:"v-date-picker-header__content"},[((n=u.default)==null?void 0:n.call(u))??e.header])]}}),l&&t("div",{class:"v-date-picker-header__append"},[u.append?t(ie,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VBtn:{icon:e.appendIcon,variant:"text"}}},{default:()=>{var n;return[(n=u.append)==null?void 0:n.call(u)]}}):t(U,{key:"append-btn",icon:e.appendIcon,variant:"text",onClick:c},null)])])}),{}}}),we=L({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...Ye()},"VDatePickerMonth"),pe=E()({name:"VDatePickerMonth",props:we(),emits:{"update:modelValue":e=>!0,"update:month":e=>!0,"update:year":e=>!0},setup(e,P){let{emit:V,slots:u}=P;const a=O(),{daysInMonth:m,model:r,weekNumbers:c}=Te(e),s=te(),l=K(),n=K(),p=K(!1),T=b(()=>p.value?e.reverseTransition:e.transition);e.multiple==="range"&&r.value.length>0&&(l.value=r.value[0],r.value.length>1&&(n.value=r.value[r.value.length-1]));const g=b(()=>{const k=["number","string"].includes(typeof e.multiple)?Number(e.multiple):1/0;return r.value.length>=k});H(m,(k,o)=>{o&&(p.value=s.isBefore(k[0].date,o[0].date))});function G(k){const o=s.startOfDay(k);if(r.value.length===0?l.value=void 0:r.value.length===1&&(l.value=r.value[0],n.value=void 0),!l.value)l.value=o,r.value=[l.value];else if(n.value)l.value=k,n.value=void 0,r.value=[l.value];else{if(s.isSameDay(o,l.value)){l.value=void 0,r.value=[];return}else s.isBefore(o,l.value)?(n.value=s.endOfDay(l.value),l.value=o):n.value=s.endOfDay(o);const x=s.getDiff(n.value,l.value,"days"),M=[l.value];for(let D=1;D<x;D++){const F=s.addDays(l.value,D);M.push(F)}M.push(n.value),r.value=M}}function w(k){const o=r.value.findIndex(x=>s.isSameDay(x,k));if(o===-1)r.value=[...r.value,k];else{const x=[...r.value];x.splice(o,1),r.value=x}}function C(k){e.multiple==="range"?G(k):e.multiple?w(k):r.value=[k]}return()=>t("div",{class:"v-date-picker-month"},[e.showWeek&&t("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!e.hideWeekdays&&t("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[Y(" ")]),c.value.map(k=>t("div",{class:["v-date-picker-month__day","v-date-picker-month__day--adjacent"]},[k]))]),t(be,{name:T.value},{default:()=>{var k;return[t("div",{ref:a,key:(k=m.value[0].date)==null?void 0:k.toString(),class:"v-date-picker-month__days"},[!e.hideWeekdays&&s.getWeekdays(e.firstDayOfWeek).map(o=>t("div",{class:["v-date-picker-month__day","v-date-picker-month__weekday"]},[o])),m.value.map((o,x)=>{const M={props:{onClick:()=>C(o.date)},item:o,i:x};return g.value&&!o.isSelected&&(o.isDisabled=!0),t("div",{class:["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":o.isAdjacent,"v-date-picker-month__day--hide-adjacent":o.isHidden,"v-date-picker-month__day--selected":o.isSelected,"v-date-picker-month__day--week-end":o.isWeekEnd,"v-date-picker-month__day--week-start":o.isWeekStart}],"data-v-date":o.isDisabled?void 0:o.isoDate},[(e.showAdjacentMonths||!o.isAdjacent)&&t(ie,{defaults:{VBtn:{class:"v-date-picker-month__day-btn",color:(o.isSelected||o.isToday)&&!o.isDisabled?e.color:void 0,disabled:o.isDisabled,icon:!0,ripple:!1,text:o.localized,variant:o.isDisabled?o.isToday?"outlined":"text":o.isToday&&!o.isSelected?"outlined":"flat",onClick:()=>C(o.date)}}},{default:()=>{var D;return[((D=u.day)==null?void 0:D.call(u,M))??t(U,M.props,null)]}})])})])]}})])}}),Se=L({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number},"VDatePickerMonths"),ge=E()({name:"VDatePickerMonths",props:Se(),emits:{"update:modelValue":e=>!0},setup(e,P){let{emit:V,slots:u}=P;const a=te(),m=ee(e,"modelValue"),r=b(()=>{let c=a.startOfYear(a.date());return e.year&&(c=a.setYear(c,e.year)),Ve(12).map(s=>{const l=a.format(c,"monthShort"),n=!!(e.min&&a.isAfter(a.startOfMonth(a.date(e.min)),c)||e.max&&a.isAfter(c,a.startOfMonth(a.date(e.max))));return c=a.getNextMonth(c),{isDisabled:n,text:l,value:s}})});return _e(()=>{m.value=m.value??a.getMonth(a.date())}),Z(()=>t("div",{class:"v-date-picker-months",style:{height:Pe(e.height)}},[t("div",{class:"v-date-picker-months__content"},[r.value.map((c,s)=>{var p;const l={active:m.value===s,color:m.value===s?e.color:void 0,disabled:c.isDisabled,rounded:!0,text:c.text,variant:m.value===c.value?"flat":"text",onClick:()=>n(s)};function n(T){if(m.value===T){V("update:modelValue",m.value);return}m.value=T}return((p=u.month)==null?void 0:p.call(u,{month:c,i:s,props:l}))??t(U,R({key:"month"},l),null)})])])),{}}}),Ce=L({color:String,height:[String,Number],min:null,max:null,modelValue:Number},"VDatePickerYears"),ye=E()({name:"VDatePickerYears",props:Ce(),emits:{"update:modelValue":e=>!0},setup(e,P){let{emit:V,slots:u}=P;const a=te(),m=ee(e,"modelValue"),r=b(()=>{const s=a.getYear(a.date());let l=s-100,n=s+52;e.min&&(l=a.getYear(a.date(e.min))),e.max&&(n=a.getYear(a.date(e.max)));let p=a.startOfYear(a.date());return p=a.setYear(p,l),Ve(n-l+1,l).map(T=>{const g=a.format(p,"year");return p=a.setYear(p,a.getYear(p)+1),{text:g,value:T}})});_e(()=>{m.value=m.value??a.getYear(a.date())});const c=Be();return Re(async()=>{var s;await Ue(),(s=c.el)==null||s.scrollIntoView({block:"center"})}),Z(()=>t("div",{class:"v-date-picker-years",style:{height:Pe(e.height)}},[t("div",{class:"v-date-picker-years__content"},[r.value.map((s,l)=>{var p;const n={ref:m.value===s.value?c:void 0,active:m.value===s.value,color:m.value===s.value?e.color:void 0,rounded:!0,text:s.text,variant:m.value===s.value?"flat":"text",onClick:()=>{if(m.value===s.value){V("update:modelValue",m.value);return}m.value=s.value}};return((p=u.year)==null?void 0:p.call(u,{year:s,i:l,props:n}))??t(U,R({key:"month"},n),null)})])])),{}}}),va=L({header:{type:String,default:"$vuetify.datePicker.header"},...De(),...we({weeksInMonth:"static"}),...ae(Se(),["modelValue"]),...ae(Ce(),["modelValue"]),...Oe({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),ma=E()({name:"VDatePicker",props:va(),emits:{"update:modelValue":e=>!0,"update:month":e=>!0,"update:year":e=>!0,"update:viewMode":e=>!0},setup(e,P){let{emit:V,slots:u}=P;const a=te(),{t:m}=We(),r=ee(e,"modelValue",void 0,d=>ne(d),d=>e.multiple?d:d[0]),c=ee(e,"viewMode"),s=b(()=>{var _;const d=a.date((_=r.value)==null?void 0:_[0]);return d&&a.isValid(d)?d:a.date()}),l=O(Number(e.month??a.getMonth(a.startOfMonth(s.value)))),n=O(Number(e.year??a.getYear(a.startOfYear(a.setMonth(s.value,l.value))))),p=K(!1),T=b(()=>e.multiple&&r.value.length>1?m("$vuetify.datePicker.itemsSelected",r.value.length):r.value[0]&&a.isValid(r.value[0])?a.format(a.date(r.value[0]),"normalDateWithWeekday"):m(e.header)),g=b(()=>{let d=a.date();return d=a.setDate(d,1),d=a.setMonth(d,l.value),d=a.setYear(d,n.value),a.format(d,"monthAndYear")}),G=b(()=>`date-picker-header${p.value?"-reverse":""}-transition`),w=b(()=>{const d=a.date(e.min);return e.min&&a.isValid(d)?d:null}),C=b(()=>{const d=a.date(e.max);return e.max&&a.isValid(d)?d:null}),k=b(()=>{if(e.disabled)return!0;const d=[];if(c.value!=="month")d.push("prev","next");else{let _=a.date();if(_=a.setYear(_,n.value),_=a.setMonth(_,l.value),w.value){const I=a.addDays(a.startOfMonth(_),-1);a.isAfter(w.value,I)&&d.push("prev")}if(C.value){const I=a.addDays(a.endOfMonth(_),1);a.isAfter(I,C.value)&&d.push("next")}}return d});function o(){l.value<11?l.value++:(n.value++,l.value=0,B(n.value)),N(l.value)}function x(){l.value>0?l.value--:(n.value--,l.value=11,B(n.value)),N(l.value)}function M(){c.value="month"}function D(){c.value=c.value==="months"?"month":"months"}function F(){c.value=c.value==="year"?"month":"year"}function N(d){c.value==="months"&&D(),V("update:month",d)}function B(d){c.value==="year"&&F(),V("update:year",d)}return H(r,(d,_)=>{const I=ne(_),W=ne(d);if(!W.length)return;const z=a.date(I[I.length-1]),$=a.date(W[W.length-1]),A=a.getMonth($),i=a.getYear($);A!==l.value&&(l.value=A,N(l.value)),i!==n.value&&(n.value=i,B(n.value)),p.value=a.isBefore(z,$)}),Z(()=>{const d=ue.filterProps(e),_=ke.filterProps(e),I=he.filterProps(e),W=pe.filterProps(e),z=ae(ge.filterProps(e),["modelValue"]),$=ae(ye.filterProps(e),["modelValue"]),A={header:T.value,transition:G.value};return t(ue,R(d,{class:["v-date-picker",`v-date-picker--${c.value}`,{"v-date-picker--show-week":e.showWeek},e.class],style:e.style}),{title:()=>{var i;return((i=u.title)==null?void 0:i.call(u))??t("div",{class:"v-date-picker__title"},[m(e.title)])},header:()=>u.header?t(ie,{defaults:{VDatePickerHeader:{...A}}},{default:()=>{var i;return[(i=u.header)==null?void 0:i.call(u,A)]}}):t(he,R({key:"header"},I,A,{onClick:c.value!=="month"?M:void 0}),{...u,default:void 0}),default:()=>t(se,null,[t(ke,R(_,{disabled:k.value,text:g.value,"onClick:next":o,"onClick:prev":x,"onClick:month":D,"onClick:year":F}),null),t($e,{hideOnLeave:!0},{default:()=>[c.value==="months"?t(ge,R({key:"date-picker-months"},z,{modelValue:l.value,"onUpdate:modelValue":[i=>l.value=i,N],min:w.value,max:C.value,year:n.value}),null):c.value==="year"?t(ye,R({key:"date-picker-years"},$,{modelValue:n.value,"onUpdate:modelValue":[i=>n.value=i,B],min:w.value,max:C.value}),null):t(pe,R({key:"date-picker-month"},W,{modelValue:r.value,"onUpdate:modelValue":i=>r.value=i,month:l.value,"onUpdate:month":[i=>l.value=i,N],year:n.value,"onUpdate:year":[i=>n.value=i,B],min:w.value,max:C.value}),null)]})]),actions:u.actions})}),{}}}),Me=e=>(Je("data-v-858164b2"),e=e(),Qe(),e),fa=Me(()=>xe("h1",null,"預約狗狗時間",-1)),ka=Me(()=>xe("h3",null,"可預約時段",-1)),ha={__name:"booking",setup(e){const P=Ee(),V=ze(),{backApi:u,apiAuth:a}=Xe(),m=Fe(),r=qe(),c=[ta,la],s=b(()=>{if(!m.isLogin){V.push("/login");return}return m.account}),l=O(new Date("")),n=b(()=>isNaN(l.value.getTime())?"左側選擇日期":l.value.toLocaleDateString()),p=O([]);(async()=>{var i,h;try{const{data:v}=await u.get("/dogs");p.value.splice(0,p.value.length,...v.result.data)}catch(v){console.log(v),r({text:((h=(i=v==null?void 0:v.response)==null?void 0:i.data)==null?void 0:h.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const g=O({_id:"",image:"",dogName:"",age:0,price:0,booking:!0,bookingTime:[],feature:"",sell:!0,counter:0});(async()=>{var i,h;try{const v=P.query.id;if(P.query.id===void 0)return;const{data:f}=await u.get("/dogs/"+v);g.value._id=f.result._id,g.value.image=f.result.image,g.value.dogName=f.result.dogName,g.value.age=f.result.age,g.value.price=f.result.price,g.value.booking=f.result.booking,g.value.bookingTime=f.result.bookingTime,g.value.feature=f.result.feature,g.value.sell=f.result.sell,g.value.counter=f.result.counter}catch(v){console.log(v),r({text:((h=(i=v==null?void 0:v.response)==null?void 0:i.data)==null?void 0:h.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const w=O(!1),C=()=>{w.value=!0},k=O([]),o=b(()=>g.value.price*k.value.length),x=Ge({name:Q().required("預約人名字必填"),phone:Q().required("預約人電話必填"),dogName:Q().required("狗狗名字必填"),bookingDate:Q().required("預約日期必填"),bookingTime:Ke().required("預約時段必填"),totalPrice:ea().required("預約總金額必填").typeError("預約總金額格式錯誤").min(0,"預約總金額不能小於 0"),accountName:Q().required("帳戶名稱必填")}),{handleSubmit:M,isSubmitting:D,resetForm:F}=aa({validationSchema:x,initialValues:{name:s.value,phone:"",dogName:"",bookingDate:"",bookingTime:[],totalPrice:0,accountName:""}}),N=j("name"),B=j("phone"),d=j("dogName"),_=j("bookingDate"),I=j("bookingTime"),W=j("totalPrice"),z=j("accountName");H(n,(i,h)=>{if(i!==h)return z.value.value=s.value,d.value.value=g.value.dogName}),H(n,(i,h)=>{if(i!==h)return k.value=[],_.value.value=n.value}),H(k,(i,h)=>{if(i!==h)return I.value.value=k.value.sort((v,f)=>parseInt(v)-parseInt(f))}),H(o,(i,h)=>{if(i!==h)return W.value.value=o.value});const $=M(async i=>{var h,v;try{const f=new FormData;f.append("name",i.name),f.append("phone",i.phone),f.append("dogName",i.dogName),f.append("bookingDate",i.bookingDate),f.append("bookingTime",i.bookingTime),f.append("totalPrice",i.totalPrice),f.append("accountName",i.accountName),await a.post("/order",f),r({text:"預約成功",snackbarProps:{color:"green"}}),F(),n.value=NaN,k.value=[],o.value=0}catch(f){console.log(f),r({text:((v=(h=f==null?void 0:f.response)==null?void 0:h.data)==null?void 0:v.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),A=b(()=>({myClass:N.value.value.length>0}));return console.log(A),(i,h)=>(X(),oe(ua,{class:"text-center my-8"},{default:y(()=>[fa,t(S(na),{slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,pagination:{clickable:!0},navigation:!0,modules:c,ref:"mySwiperRef",class:"mySwiper my-10"},{default:y(()=>[(X(!0),de(se,null,ce(p.value,v=>(X(),oe(S(oa),{key:v._id},{default:y(()=>[t(J,{style:{width:"100%"}},{default:y(()=>[t(Ze,R({ref_for:!0},v),null,16)]),_:2},1024)]),_:2},1024))),128))]),_:1},512),t(ia,{class:"my-7"},{default:y(()=>[t(fe,{class:"d-flex flex-wrap justify-center",cols:"12",sm:"6"},{default:y(()=>[t(ma,{width:"400",color:"primary",modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=v=>l.value=v),"show-adjacent-months":"",onClick:C},null,8,["modelValue"]),t(He,{modelValue:w.value,"onUpdate:modelValue":h[2]||(h[2]=v=>w.value=v),width:"auto"},{default:y(()=>[t(me,null,{default:y(()=>[t(J,{class:"bg-white d-flex flex-column text-center justify-self-center pa-7",width:"350"},{default:y(()=>[ka,t(ra,{class:"my-4"}),(X(!0),de(se,null,ce(g.value.bookingTime.join(" ").split(",").sort((v,f)=>parseInt(v)-parseInt(f)),v=>(X(),oe(da,{class:"d-flex justify-center",modelValue:k.value,"onUpdate:modelValue":h[1]||(h[1]=f=>k.value=f),label:v,value:v,"false-icon":"mdi-paw-outline","true-icon":"mdi-paw"},null,8,["modelValue","label","value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(fe,{class:"d-flex justify-center"},{default:y(()=>[t(me,{class:"w-90",cols:"12",sm:"6",onSubmit:Le(S($),["prevent"]),disabled:S(D)},{default:y(()=>[t(q,{label:"預約人姓名",class:ve(A.value),modelValue:S(N).value.value,"onUpdate:modelValue":h[3]||(h[3]=v=>S(N).value.value=v),"error-messages":S(N).errorMessage.value},null,8,["class","modelValue","error-messages"]),t(q,{label:"預約人電話",class:ve(A.value),modelValue:S(B).value.value,"onUpdate:modelValue":h[4]||(h[4]=v=>S(B).value.value=v),"error-messages":S(B).errorMessage.value},null,8,["class","modelValue","error-messages"]),t(q,{readonly:""},{default:y(()=>[Y("預約狗狗： "),t(J,{class:"text-h6 font-weight-bold bg-transparent"},{default:y(()=>[Y(re(g.value.dogName),1)]),_:1})]),_:1}),t(q,{readonly:""},{default:y(()=>[Y("預約日期： "),t(J,{class:"text-h6 font-weight-bold bg-transparent"},{default:y(()=>[Y(re(n.value),1)]),_:1})]),_:1}),t(q,{readonly:""},{default:y(()=>[Y("預約時間： "),t(sa,{class:"my-0 pa-0 bg-transparent",items:k.value.sort((v,f)=>parseInt(v)-parseInt(f))},null,8,["items"])]),_:1}),t(q,{readonly:""},{default:y(()=>[Y("總計金額： "),t(J,{class:"text-h5 font-weight-bold bg-transparent"},{default:y(()=>[Y(re(o.value),1)]),_:1}),Y(" 元 ")]),_:1}),t(U,{class:"w-40 mt-5",type:"submit",color:"green",loading:S(D)},{default:y(()=>[Y("送出預約")]),_:1},8,["loading"])]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1}))}},Ca=je(ha,[["__scopeId","data-v-858164b2"]]);export{Ca as default};
