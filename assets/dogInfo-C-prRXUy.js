import{p as ue,s as ie,ai as Ae,J as z,B as j,aj as Ge,K as $e,t as de,e as a,F as L,W as A,ak as Be,al as He,am as pe,an as Ee,S as Ne,ao as _e,ap as re,aq as ze,ar as Le,as as Oe,at as je,r as b,I as qe,X as Ke,P as Je,w as X,Q as We,au as Qe,av as Xe,aw as be,ax as Ye,ay as Ze,az as ea,aA as aa,ag as ce,aB as ta,M as la,O as oa,i as na,o as q,k as Y,f as n,l as ne,a1 as M,aC as sa,a0 as ra,j as d,aD as me,aE as Ve,a2 as ye,aF as ua,aG as se,V as xe,ah as ae,$ as ve,aH as ia,d as ke,h as Pe,m as he,aI as da,aJ as ca,aK as ma,g as va,aL as we,aM as fa,c as ga}from"./index-Bo41hmNo.js";import{c as pa,a as fe,b as Se,d as ba,e as Va,u as ya,f as K,V as xa}from"./vee-validate.esm-DBxpqnGY.js";import{b as Ie}from"./route-block-B_A1xBdJ.js";import{V as Z}from"./VCol-Cz6DkMcF.js";import{V as ee}from"./VRow-gZ5tCjm5.js";import{V as ka}from"./VCheckbox-CcWQJJPn.js";import{m as Pa,V as ge,a as ha,b as wa}from"./VCheckboxBtn-CaRgDKG2.js";import{V as Ue}from"./VDivider-Bbq3jSFh.js";import{m as Sa,a as Ia,b as Ca,c as Ta,d as Fa,e as Ra,f as Da,u as Ba,p as Na,g as _a,h as Ua,i as Ma,j as Aa,k as Ga,l as $a,V as Ce,n as Te,o as Fe,q as Re}from"./VDataTable-_AEWdIU-.js";import{a as Ha,V as Ea}from"./VList-BDrd91hs.js";import{V as za}from"./VContainer-Bgf_6l1B.js";import"./VPagination-6Z9E9ckH.js";const La=ue({itemsLength:{type:[Number,String],required:!0},...Sa(),...Ia(),...Ca()},"VDataTableServer"),Oa=ie()({name:"VDataTableServer",props:La(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,G){let{attrs:w,slots:o}=G;const{groupBy:v}=Ta(e),{sortBy:c,multiSort:i,mustSort:$}=Fa(e),{page:C,itemsPerPage:U}=Ra(e),{disableSort:O}=Ae(e),R=z(()=>parseInt(e.itemsLength,10)),{columns:T,headers:y}=Da(e,{groupBy:v,showSelect:j(e,"showSelect"),showExpand:j(e,"showExpand")}),{items:k}=Ba(e,T),{toggleSort:P}=Na({sortBy:c,multiSort:i,mustSort:$,page:C}),{opened:D,isGroupOpen:I,toggleGroup:H,extractRows:E}=_a({groupBy:v,sortBy:c,disableSort:O}),{pageCount:B,setItemsPerPage:J}=Ua({page:C,itemsPerPage:U,itemsLength:R}),{flatItems:F}=Ma(k,v,D),{isSelected:N,select:_,selectAll:S,toggleSelect:h,someSelected:u,allSelected:p}=Aa(e,{allItems:k,currentPage:k}),{isExpanded:f,toggleExpand:V}=Ga(e),x=z(()=>E(k.value));$a({page:C,itemsPerPage:U,sortBy:c,groupBy:v,search:j(e,"search")}),Ge("v-data-table",{toggleSort:P,sortBy:c}),$e({VDataTableRows:{hideNoData:j(e,"hideNoData"),noDataText:j(e,"noDataText"),loading:j(e,"loading"),loadingText:j(e,"loadingText")}});const s=z(()=>({page:C.value,itemsPerPage:U.value,sortBy:c.value,pageCount:B.value,toggleSort:P,setItemsPerPage:J,someSelected:u.value,allSelected:p.value,isSelected:N,select:_,selectAll:S,toggleSelect:h,isExpanded:f,toggleExpand:V,isGroupOpen:I,toggleGroup:H,items:x.value.map(l=>l.raw),internalItems:x.value,groupedItems:F.value,columns:T.value,headers:y.value}));de(()=>{const l=Ce.filterProps(e),g=Te.filterProps(e),t=Fe.filterProps(e),r=Re.filterProps(e);return a(Re,A({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},r),{top:()=>{var m;return(m=o.top)==null?void 0:m.call(o,s.value)},default:()=>{var m,te,le,oe,W,Q;return o.default?o.default(s.value):a(L,null,[(m=o.colgroup)==null?void 0:m.call(o,s.value),!e.hideDefaultHeader&&a("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[a(Te,A(g,{sticky:e.fixedHeader}),o)]),(te=o.thead)==null?void 0:te.call(o,s.value),!e.hideDefaultBody&&a("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(le=o["body.prepend"])==null?void 0:le.call(o,s.value),o.body?o.body(s.value):a(Fe,A(w,t,{items:F.value}),o),(oe=o["body.append"])==null?void 0:oe.call(o,s.value)]),(W=o.tbody)==null?void 0:W.call(o,s.value),(Q=o.tfoot)==null?void 0:Q.call(o,s.value)])},bottom:()=>o.bottom?o.bottom(s.value):!e.hideDefaultFooter&&a(L,null,[a(Ue,null,null),a(Ce,l,{prepend:o["footer.prepend"]})])})})}}),ja=ue({...Pa({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),De=ie()({name:"VRadio",props:ja(),setup(e,G){let{slots:w}=G;return de(()=>{const o=ge.filterProps(e);return a(ge,A(o,{class:["v-radio",e.class],style:e.style,type:"radio"}),w)}),{}}}),qa=ue({height:{type:[Number,String],default:"auto"},...Be(),...He(ha(),["multiple"]),trueIcon:{type:pe,default:"$radioOn"},falseIcon:{type:pe,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Ka=ie()({name:"VRadioGroup",inheritAttrs:!1,props:qa(),emits:{"update:modelValue":e=>!0},setup(e,G){let{attrs:w,slots:o}=G;const v=Ee(),c=z(()=>e.id||`radio-group-${v}`),i=Ne(e,"modelValue");return de(()=>{const[$,C]=_e(w),U=re.filterProps(e),O=ge.filterProps(e),R=o.label?o.label({label:e.label,props:{for:c.value}}):e.label;return a(re,A({class:["v-radio-group",e.class],style:e.style},$,U,{modelValue:i.value,"onUpdate:modelValue":T=>i.value=T,id:c.value}),{...o,default:T=>{let{id:y,messagesId:k,isDisabled:P,isReadonly:D}=T;return a(L,null,[R&&a(ze,{id:y.value},{default:()=>[R]}),a(wa,A(O,{id:y.value,"aria-describedby":k.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:P.value,readonly:D.value,"aria-labelledby":R?y.value:void 0,multiple:!1},C,{modelValue:i.value,"onUpdate:modelValue":I=>i.value=I}),o)])}})}),{}}}),Ja=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Be(),...Le()},"VTextarea"),Wa=ie()({name:"VTextarea",directives:{Intersect:Oe},inheritAttrs:!1,props:Ja(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,G){let{attrs:w,emit:o,slots:v}=G;const c=Ne(e,"modelValue"),{isFocused:i,focus:$,blur:C}=je(e),U=z(()=>typeof e.counterValue=="function"?e.counterValue(c.value):(c.value||"").toString().length),O=z(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function R(u,p){var f,V;!e.autofocus||!u||(V=(f=p[0].target)==null?void 0:f.focus)==null||V.call(f)}const T=b(),y=b(),k=qe(""),P=b(),D=z(()=>e.persistentPlaceholder||i.value||e.active);function I(){var u;P.value!==document.activeElement&&((u=P.value)==null||u.focus()),i.value||$()}function H(u){I(),o("click:control",u)}function E(u){o("mousedown:control",u)}function B(u){u.stopPropagation(),I(),ce(()=>{c.value="",ta(e["onClick:clear"],u)})}function J(u){var f;const p=u.target;if(c.value=p.value,(f=e.modelModifiers)!=null&&f.trim){const V=[p.selectionStart,p.selectionEnd];ce(()=>{p.selectionStart=V[0],p.selectionEnd=V[1]})}}const F=b(),N=b(+e.rows),_=z(()=>["plain","underlined"].includes(e.variant));Ke(()=>{e.autoGrow||(N.value=+e.rows)});function S(){e.autoGrow&&ce(()=>{if(!F.value||!y.value)return;const u=getComputedStyle(F.value),p=getComputedStyle(y.value.$el),f=parseFloat(u.getPropertyValue("--v-field-padding-top"))+parseFloat(u.getPropertyValue("--v-input-padding-top"))+parseFloat(u.getPropertyValue("--v-field-padding-bottom")),V=F.value.scrollHeight,x=parseFloat(u.lineHeight),s=Math.max(parseFloat(e.rows)*x+f,parseFloat(p.getPropertyValue("--v-input-control-height"))),l=parseFloat(e.maxRows)*x+f||1/0,g=oa(V??0,s,l);N.value=Math.floor((g-f)/x),k.value=la(g)})}Je(S),X(c,S),X(()=>e.rows,S),X(()=>e.maxRows,S),X(()=>e.density,S);let h;return X(F,u=>{u?(h=new ResizeObserver(S),h.observe(F.value)):h==null||h.disconnect()}),We(()=>{h==null||h.disconnect()}),de(()=>{const u=!!(v.counter||e.counter||e.counterValue),p=!!(u||v.details),[f,V]=_e(w),{modelValue:x,...s}=re.filterProps(e),l=Qe(e);return a(re,A({ref:T,modelValue:c.value,"onUpdate:modelValue":g=>c.value=g,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":_.value},e.class],style:e.style},f,s,{centerAffix:N.value===1&&!_.value,focused:i.value}),{...v,default:g=>{let{id:t,isDisabled:r,isDirty:m,isReadonly:te,isValid:le}=g;return a(Xe,A({ref:y,style:{"--v-textarea-control-height":k.value},onClick:H,onMousedown:E,"onClick:clear":B,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},l,{id:t.value,active:D.value||m.value,centerAffix:N.value===1&&!_.value,dirty:m.value||e.dirty,disabled:r.value,focused:i.value,error:le.value===!1}),{...v,default:oe=>{let{props:{class:W,...Q}}=oe;return a(L,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),be(a("textarea",A({ref:P,class:W,value:c.value,onInput:J,autofocus:e.autofocus,readonly:te.value,disabled:r.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:I,onBlur:C},Q,V),null),[[Ye("intersect"),{handler:R},null,{once:!0}]]),e.autoGrow&&be(a("textarea",{class:[W,"v-textarea__sizer"],id:`${Q.id}-sizer`,"onUpdate:modelValue":Me=>c.value=Me,ref:F,readonly:!0,"aria-hidden":"true"},null),[[Ze,c.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:p?g=>{var t;return a(L,null,[(t=v.details)==null?void 0:t.call(v,g),u&&a(L,null,[a("span",null,null),a(ea,{active:e.persistentCounter||i.value,value:U.value,max:O.value,disabled:e.disabled},v.counter)])])}:void 0})}),aa({},T,y,P)}}),Qa=ae("h1",null,"狗狗資訊管理",-1),Xa=ae("p",null,"狗狗大頭照：",-1),Ya=ae("h3",null,"狗狗個人資訊",-1),Za={__name:"dogInfo",setup(e){const{backApi:G,apiAuth:w}=fa(),o=na(),v=b(null),c=b(["10:00～12:00","13:00～15:00","15:00～17:00","19:00～21:00"]),i=b({open:!1,id:""}),$=s=>{s?(i.value.id=s._id,k.value.value=s.dogName,P.value.value=s.age,y.value.value=s.price,I.value.value=s.booking,H.value.value=s.bookingTime,D.value.value=s.feature,E.value.value=s.sell):i.value.id="",i.value.open=!0},C=()=>{i.value.open=!1,T(),v.value.deleteFileRecord()},U=pa({dogName:fe().required("狗狗名字必填"),age:Se().required("狗狗年齡必填").min(0,"年齡不能小於 0"),price:Se().required("預約價格必填").typeError("商品價格格式錯誤").min(0,"商品價格不能小於 0"),booking:fe().required("預約狀態必填"),bookingTime:ba(),feature:fe().required("狗狗性格、特徵必填"),sell:Va()}),{handleSubmit:O,isSubmitting:R,resetForm:T}=ya({validationSchema:U,initialValues:{dogName:"",age:0,price:0,booking:"",bookingTime:[],feature:"",sell:!0}}),y=K("price"),k=K("dogName"),P=K("age"),D=K("feature"),I=K("booking"),H=K("bookingTime"),E=K("sell"),B=b([]),J=b([]),F=O(async s=>{var l,g,t;if(!((l=B.value[0])!=null&&l.error)&&!(i.value.id.length===0&&B.value.length<1))try{const r=new FormData;r.append("dogName",s.dogName),r.append("age",s.age),r.append("price",s.price),r.append("booking",s.booking),r.append("bookingTime",s.bookingTime),r.append("feature",s.feature),r.append("sell",s.sell),B.value.length>0&&r.append("image",B.value[0].file),i.value.id===""?await w.post("/dogs",r):await w.patch("/dogs/"+i.value.id,r),o({text:i.value.id===""?"新增成功":"編輯成功",snackbarProps:{color:"green"}}),C(),x(!0)}catch(r){console.log(r),o({text:((t=(g=r==null?void 0:r.response)==null?void 0:g.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),N=b(10),_=b([{key:"createdAt",order:"desc"}]),S=b(1),h=b([]),u=[{title:"名字",align:"center",sortable:!0,key:"dogName"},{title:"大頭照",align:"center",sortable:!1,key:"image"},{title:"年齡",align:"center",sortable:!0,key:"age"},{title:"價格",align:"center",sortable:!0,key:"price"},{title:"預約狀態",align:"center",sortable:!0,key:"booking"},{title:"預約時段",align:"center",sortable:!0,key:"bookingTime"},{title:"性格、特徵",align:"center",sortable:!1,key:"feature"},{title:"點檯",align:"center",sortable:!0,key:"counter"},{title:"上下架",align:"center",sortable:!1,key:"sell"},{title:"編輯",align:"center",sortable:!1,key:"edit"}],p=b(!0),f=b(0),V=b(""),x=async s=>{var l,g,t,r;s&&(S.value=1),p.value=!0;try{const{data:m}=await w.get("/dogs/all",{params:{page:S.value,itemsPerPage:N.value,sortBy:((l=_.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((g=_.value[0])==null?void 0:g.order)||"desc",search:V.value}});h.value.splice(0,h.value.length,...m.result.data),f.value=m.result.total}catch(m){console.log(m),o({text:((r=(t=m==null?void 0:m.response)==null?void 0:t.data)==null?void 0:r.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};return x(),(s,l)=>{const g=ga("vue-file-agent");return q(),Y(za,{fluid:""},{default:n(()=>[a(ee,{class:"text-center"},{default:n(()=>[a(Z,null,{default:n(()=>[Qa]),_:1})]),_:1}),a(ee,{class:"text-center"},{default:n(()=>[a(Z,null,{default:n(()=>[a(ne,{color:"green",onClick:l[0]||(l[0]=t=>$(null))},{default:n(()=>[M("新增夥伴資訊")]),_:1})]),_:1}),a(sa,{modelValue:i.value.open,"onUpdate:modelValue":l[10]||(l[10]=t=>i.value.open=t),persistent:"",width:"500"},{default:n(()=>[a(xa,{onSubmit:ra(d(F),["prevent"])},{default:n(()=>[a(me,null,{default:n(()=>[a(Ve,null,{default:n(()=>[M(ye(i.value.id?"編輯狗狗資訊":"新增狗狗資訊"),1)]),_:1}),a(ua,{class:"pb-0"},{default:n(()=>[Xa,a(g,{modelValue:B.value,"onUpdate:modelValue":l[1]||(l[1]=t=>B.value=t),"raw-model-value":J.value,"onUpdate:rawModelValue":l[2]||(l[2]=t=>J.value=t),accept:"image/jpeg,image/jpg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:v},null,8,["modelValue","raw-model-value"]),a(ee,{class:"mt-4"},{default:n(()=>[a(Z,null,{default:n(()=>[a(se,{label:"狗狗名字",modelValue:d(k).value.value,"onUpdate:modelValue":l[3]||(l[3]=t=>d(k).value.value=t),"error-messages":d(k).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(Z,null,{default:n(()=>[a(se,{label:"年齡",type:"number",min:"0",modelValue:d(P).value.value,"onUpdate:modelValue":l[4]||(l[4]=t=>d(P).value.value=t),"error-messages":d(P).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),a(ee,{class:"d-flex ma-0"},{default:n(()=>[a(Z,{class:"d-flex align-self-center ps-0"},{default:n(()=>[a(se,{label:"預約價格",type:"number",min:"0",modelValue:d(y).value.value,"onUpdate:modelValue":l[5]||(l[5]=t=>d(y).value.value=t),"error-messages":d(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(ka,{label:"上架",class:"d-flex justify-center",modelValue:d(E).value.value,"onUpdate:modelValue":l[6]||(l[6]=t=>d(E).value.value=t),"error-messages":d(E).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(Ka,{class:"d-flex",inline:"","hide-spin-buttons":"",modelValue:d(I).value.value,"onUpdate:modelValue":l[7]||(l[7]=t=>d(I).value.value=t)},{default:n(()=>[a(xe,{class:"d-flex align-center"},{default:n(()=>[ae("p",null,[a(ve,{class:"me-1"},{default:n(()=>[M("mdi-invoice-clock")]),_:1}),M("預約狀態：")])]),_:1}),a(De,{label:"可預約",value:"可預約"}),a(De,{label:"預約已滿",value:"預約已滿"})]),_:1},8,["modelValue"]),d(I).value.value==="可預約"?(q(),Y(xe,{key:0,class:"mt-4"},{default:n(()=>[ae("p",null,[a(ve,{class:"me-1"},{default:n(()=>[M("mdi-clock")]),_:1}),M("可預約時段：")]),a(ia,{"selected-class":"bg-amber-darken-4",multiple:"",modelValue:d(H).value.value,"onUpdate:modelValue":l[8]||(l[8]=t=>d(H).value.value=t),"error-messages":d(H).errorMessage.value},{default:n(()=>[(q(!0),ke(L,null,Pe(c.value,t=>(q(),Y(we,{key:t,text:t,value:t},null,8,["text","value"]))),128))]),_:1},8,["modelValue","error-messages"])]),_:1})):he("",!0),a(Wa,{label:"狗狗的性格、特徵",class:"mt-6",modelValue:d(D).value.value,"onUpdate:modelValue":l[9]||(l[9]=t=>d(D).value.value=t),"error-messages":d(D).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(da,{class:"justify-center mb-5"},{default:n(()=>[a(ne,{class:"bg-red me-5",loading:d(R),onClick:C},{default:n(()=>[M("取消")]),_:1},8,["loading"]),a(ne,{class:"bg-green",type:"submit",loading:d(R)},{default:n(()=>[M("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1}),a(ee,{class:"justify-center mt-10",width:"1500"},{default:n(()=>[a(me,{flat:""},{default:n(()=>[a(Ve,{class:"d-flex align-center pe-2"},{default:n(()=>[Ya,a(ca),a(se,{label:"搜尋",modelValue:V.value,"onUpdate:modelValue":l[11]||(l[11]=t=>V.value=t),density:"comfortable","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"","onClick:prependInner":l[12]||(l[12]=t=>x(!0)),onKeydown:l[13]||(l[13]=ma(t=>x(!0),["enter"]))},null,8,["modelValue"])]),_:1}),a(Ue),a(Oa,{class:"text-center","items-per-page":N.value,"onUpdate:itemsPerPage":[l[14]||(l[14]=t=>N.value=t),l[17]||(l[17]=t=>x(!1))],"sort-by":_.value,"onUpdate:sortBy":[l[15]||(l[15]=t=>_.value=t),l[18]||(l[18]=t=>x(!1))],page:S.value,"onUpdate:page":[l[16]||(l[16]=t=>S.value=t),l[19]||(l[19]=t=>x(!1))],items:h.value,headers:u,"items-length":f.value,loading:p.value,search:V.value},{"item.image":n(({value:t})=>[a(me,{class:"my-2",elevation:"2",rounded:""},{default:n(()=>[a(va,{src:t,width:"200",height:"150",cover:""},null,8,["src"])]),_:2},1024)]),"item.booking":n(({value:t})=>[a(we,{text:t,color:t==="可預約"?"green":"red",size:"small",label:""},null,8,["text","color"])]),"item.bookingTime":n(({value:t})=>[a(Ha,null,{default:n(()=>[(q(!0),ke(L,null,Pe(t.join(" ").split(",").sort((r,m)=>parseInt(r)-parseInt(m)),(r,m)=>(q(),Y(Ea,{key:m},{default:n(()=>[M(ye(r),1)]),_:2},1024))),128))]),_:2},1024)]),"item.sell":n(({value:t})=>[t?(q(),Y(ve,{key:0,icon:"mdi-check"})):he("",!0)]),"item.edit":n(({item:t})=>[a(ne,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:r=>$(t)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","items-length","loading","search"])]),_:1})]),_:1})]),_:1})}}};typeof Ie=="function"&&Ie(Za);export{Za as default};
