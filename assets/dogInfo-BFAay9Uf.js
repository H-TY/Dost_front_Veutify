import{p as re,q as ne,aw as Re,I as ee,A as R,ax as Be,J as Ue,s as ue,e as a,F as z,W as L,ay as _e,az as $e,aA as ge,aB as Fe,S as Ne,aC as Ae,aD as pe,aE as Ge,i as Me,r as g,o as M,j as Q,w as s,k as X,a3 as x,a6 as Le,a1 as qe,f as u,a7 as le,a8 as ve,a4 as fe,a9 as je,a5 as Y,V as be,Z as J,a0 as Ve,aF as Ee,d as ye,h as ke,l as He,aa as Oe,aG as ze,aH as Je,g as Ke,aI as Pe,aJ as We,c as Ze}from"./index-C6hPPNgW.js";import{c as Qe,a as te,b as oe,d as Xe,e as Ye,u as ea,f as D,V as aa}from"./vee-validate.esm-D7695mzm.js";import{b as xe}from"./route-block-B_A1xBdJ.js";import{V as H}from"./VCol-DBGyTMxG.js";import{V as O}from"./VRow-olADdN87.js";import{V as Se,a as la}from"./VTextarea-6G_Rzn7E.js";import{m as ta,V as se,a as oa,b as sa}from"./VCheckboxBtn-65vbBOPN.js";import{V as Ce}from"./VDivider-CPSp19bt.js";import{m as ra,a as na,b as ua,c as da,d as ia,e as ma,f as ca,u as ga,p as pa,g as va,h as fa,i as ba,j as Va,k as ya,l as ka,V as Te,n as Ie,o as he,q as we}from"./VDataTable-B7lHWvQ3.js";import{a as Pa,V as xa}from"./VList-DX09FZYT.js";import{V as Sa}from"./VContainer-Bs8Bopcz.js";import"./VPagination-CZXBOg6S.js";const Ta=re({itemsLength:{type:[Number,String],required:!0},...ra(),...na(),...ua()},"VDataTableServer"),Ia=ne()({name:"VDataTableServer",props:Ta(),emits:{"update:modelValue":l=>!0,"update:page":l=>!0,"update:itemsPerPage":l=>!0,"update:sortBy":l=>!0,"update:options":l=>!0,"update:expanded":l=>!0,"update:groupBy":l=>!0},setup(l,B){let{attrs:v,slots:o}=B;const{groupBy:y}=da(l),{sortBy:f,multiSort:d,mustSort:U}=ia(l),{page:k,itemsPerPage:C}=ma(l),{disableSort:q}=Re(l),S=ee(()=>parseInt(l.itemsLength,10)),{columns:T,headers:b}=ca(l,{groupBy:y,showSelect:R(l,"showSelect"),showExpand:R(l,"showExpand")}),{items:p}=ga(l,T),{toggleSort:P}=pa({sortBy:f,multiSort:d,mustSort:U,page:k}),{opened:I,isGroupOpen:h,toggleGroup:_,extractRows:$}=va({groupBy:y,sortBy:f,disableSort:q}),{pageCount:w,setItemsPerPage:K}=fa({page:k,itemsPerPage:C,itemsLength:S}),{flatItems:W}=ba(p,y,I),{isSelected:j,select:F,selectAll:N,toggleSelect:A,someSelected:ae,allSelected:E}=Va(l,{allItems:p,currentPage:p}),{isExpanded:Z,toggleExpand:G}=ya(l),V=ee(()=>$(p.value));ka({page:k,itemsPerPage:C,sortBy:f,groupBy:y,search:R(l,"search")}),Be("v-data-table",{toggleSort:P,sortBy:f}),Ue({VDataTableRows:{hideNoData:R(l,"hideNoData"),noDataText:R(l,"noDataText"),loading:R(l,"loading"),loadingText:R(l,"loadingText")}});const c=ee(()=>({page:k.value,itemsPerPage:C.value,sortBy:f.value,pageCount:w.value,toggleSort:P,setItemsPerPage:K,someSelected:ae.value,allSelected:E.value,isSelected:j,select:F,selectAll:N,toggleSelect:A,isExpanded:Z,toggleExpand:G,isGroupOpen:h,toggleGroup:_,items:V.value.map(n=>n.raw),internalItems:V.value,groupedItems:W.value,columns:T.value,headers:b.value}));ue(()=>{const n=Te.filterProps(l),t=Ie.filterProps(l),m=he.filterProps(l),e=we.filterProps(l);return a(we,L({class:["v-data-table",{"v-data-table--loading":l.loading},l.class],style:l.style},e),{top:()=>{var r;return(r=o.top)==null?void 0:r.call(o,c.value)},default:()=>{var r,i,de,ie,me,ce;return o.default?o.default(c.value):a(z,null,[(r=o.colgroup)==null?void 0:r.call(o,c.value),!l.hideDefaultHeader&&a("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[a(Ie,L(t,{sticky:l.fixedHeader}),o)]),(i=o.thead)==null?void 0:i.call(o,c.value),!l.hideDefaultBody&&a("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(de=o["body.prepend"])==null?void 0:de.call(o,c.value),o.body?o.body(c.value):a(he,L(v,m,{items:W.value}),o),(ie=o["body.append"])==null?void 0:ie.call(o,c.value)]),(me=o.tbody)==null?void 0:me.call(o,c.value),(ce=o.tfoot)==null?void 0:ce.call(o,c.value)])},bottom:()=>o.bottom?o.bottom(c.value):!l.hideDefaultFooter&&a(z,null,[a(Ce,null,null),a(Te,n,{prepend:o["footer.prepend"]})])})})}}),ha=re({...ta({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),De=ne()({name:"VRadio",props:ha(),setup(l,B){let{slots:v}=B;return ue(()=>{const o=se.filterProps(l);return a(se,L(o,{class:["v-radio",l.class],style:l.style,type:"radio"}),v)}),{}}}),wa=re({height:{type:[Number,String],default:"auto"},..._e(),...$e(oa(),["multiple"]),trueIcon:{type:ge,default:"$radioOn"},falseIcon:{type:ge,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Da=ne()({name:"VRadioGroup",inheritAttrs:!1,props:wa(),emits:{"update:modelValue":l=>!0},setup(l,B){let{attrs:v,slots:o}=B;const y=Fe(),f=ee(()=>l.id||`radio-group-${y}`),d=Ne(l,"modelValue");return ue(()=>{const[U,k]=Ae(v),C=pe.filterProps(l),q=se.filterProps(l),S=o.label?o.label({label:l.label,props:{for:f.value}}):l.label;return a(pe,L({class:["v-radio-group",l.class],style:l.style},U,C,{modelValue:d.value,"onUpdate:modelValue":T=>d.value=T,id:f.value}),{...o,default:T=>{let{id:b,messagesId:p,isDisabled:P,isReadonly:I}=T;return a(z,null,[S&&a(Ge,{id:b.value},{default:()=>[S]}),a(sa,L(q,{id:b.value,"aria-describedby":p.value,defaultsTarget:"VRadio",trueIcon:l.trueIcon,falseIcon:l.falseIcon,type:l.type,disabled:P.value,readonly:I.value,"aria-labelledby":S?b.value:void 0,multiple:!1},k,{modelValue:d.value,"onUpdate:modelValue":h=>d.value=h}),o)])}})}),{}}}),Ca=J("h1",null,"狗狗資訊管理",-1),Ra=J("p",null,"狗狗大頭照：",-1),Ba=J("h3",null,"狗狗個人資訊",-1),Ua={__name:"dogInfo",setup(l){const{backApi:B,apiAuth:v}=We(),o=Me(),y=g(null),f=g(["10:00～12:00","13:00～15:00","15:00～17:00","19:00～21:00"]),d=g({open:!1,id:""}),U=n=>{n?(d.value.id=n._id,p.value.value=n.dogName,P.value.value=n.age,b.value.value=n.price,h.value.value=n.booking,_.value.value=n.bookingTime,I.value.value=n.feature,$.value.value=n.sell):d.value.id="",d.value.open=!0},k=()=>{d.value.open=!1,T(),y.value.deleteFileRecord()},C=Qe({dogName:te().required("狗狗名字必填"),age:oe().required("狗狗年齡必填").min(0,"年齡不能小於 0"),price:oe().required("預約價格必填").typeError("商品價格格式錯誤").min(0,"商品價格不能小於 0"),booking:te().required("預約狀態必填"),bookingTime:Xe(),feature:te().required("狗狗性格、特徵必填"),sell:Ye(),counter:oe().required("點檯數字必填").min(0,"點檯數字不能小於 0")}),{handleSubmit:q,isSubmitting:S,resetForm:T}=ea({validationSchema:C,initialValues:{dogName:"",age:0,price:0,booking:"",bookingTime:[],feature:"",sell:!0,counter:0}}),b=D("price"),p=D("dogName"),P=D("age"),I=D("feature"),h=D("booking"),_=D("bookingTime"),$=D("sell");D("counter");const w=g([]),K=g([]),W=q(async n=>{var t,m,e;if(!((t=w.value[0])!=null&&t.error)&&!(d.value.id.length===0&&w.value.length<1))try{const r=new FormData;r.append("dogName",n.dogName),r.append("age",n.age),r.append("price",n.price),r.append("booking",n.booking),r.append("bookingTime",n.bookingTime),r.append("feature",n.feature),r.append("sell",n.sell),r.append("counter",n.counter),w.value.length>0&&r.append("image",w.value[0].file),d.value.id===""?await v.post("/dogs",r):await v.patch("/dogs/"+d.value.id,r),o({text:d.value.id===""?"新增成功":"編輯成功",snackbarProps:{color:"green"}}),k(),V(!0)}catch(r){console.log(r),o({text:((e=(m=r==null?void 0:r.response)==null?void 0:m.data)==null?void 0:e.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),j=g(10),F=g([{key:"createdAt",order:"desc"}]),N=g(1),A=g([]),ae=[{title:"名字",align:"center",sortable:!0,key:"dogName"},{title:"大頭照",align:"center",sortable:!1,key:"image"},{title:"年齡",align:"center",sortable:!0,key:"age"},{title:"價格",align:"center",sortable:!0,key:"price"},{title:"預約狀態",align:"center",sortable:!0,key:"booking"},{title:"預約時段",align:"center",sortable:!0,key:"bookingTime"},{title:"性格、特徵",align:"center",sortable:!1,key:"feature"},{title:"點檯次數",align:"center",sortable:!0,key:"counter"},{title:"上下架",align:"center",sortable:!1,key:"sell"},{title:"編輯",align:"center",sortable:!1,key:"edit"}],E=g(!0),Z=g(0),G=g(""),V=async n=>{var t,m,e,r;n&&(N.value=1),E.value=!0;try{const{data:i}=await v.get("/dogs/all",{params:{page:N.value,itemsPerPage:j.value,sortBy:((t=F.value[0])==null?void 0:t.key)||"createdAt",sortOrder:((m=F.value[0])==null?void 0:m.order)||"desc",search:G.value}});A.value.splice(0,A.value.length,...i.result.data),Z.value=i.result.total}catch(i){console.log(i),o({text:((r=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:r.message)||"發生錯誤",snackbarProps:{color:"red"}})}E.value=!1};V();const c=async(n,t)=>{try{await v.patch("/dogs/"+n,{sell:t});const m=A.value.find(e=>e._id===n);m&&(m.sell=t),o({text:t===!0?"上架成功":"下架完成",snackbarProps:{color:"green"}})}catch(m){console.log(m),o({text:m.response.data.message,snackbarProps:{color:"red",class:"custom-snackbar"}})}};return(n,t)=>{const m=Ze("vue-file-agent");return M(),Q(Sa,{fluid:""},{default:s(()=>[a(O,{class:"text-center"},{default:s(()=>[a(H,null,{default:s(()=>[Ca]),_:1})]),_:1}),a(O,{class:"text-center"},{default:s(()=>[a(H,null,{default:s(()=>[a(X,{class:"d-inline-flex pa-4",color:"green",onClick:t[0]||(t[0]=e=>U(null))},{default:s(()=>[x("新增夥伴資訊")]),_:1})]),_:1}),a(Le,{modelValue:d.value.open,"onUpdate:modelValue":t[10]||(t[10]=e=>d.value.open=e),persistent:"",width:"500"},{default:s(()=>[a(aa,{onSubmit:qe(u(W),["prevent"])},{default:s(()=>[a(le,null,{default:s(()=>[a(ve,null,{default:s(()=>[x(fe(d.value.id?"編輯狗狗資訊":"新增狗狗資訊"),1)]),_:1}),a(je,{class:"pb-0"},{default:s(()=>[Ra,a(m,{modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=e=>w.value=e),"raw-model-value":K.value,"onUpdate:rawModelValue":t[2]||(t[2]=e=>K.value=e),accept:"image/jpeg,image/jpg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:y},null,8,["modelValue","raw-model-value"]),a(O,{class:"mt-4"},{default:s(()=>[a(H,null,{default:s(()=>[a(Y,{label:"狗狗名字",modelValue:u(p).value.value,"onUpdate:modelValue":t[3]||(t[3]=e=>u(p).value.value=e),"error-messages":u(p).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(H,null,{default:s(()=>[a(Y,{label:"年齡",type:"number",min:"0",modelValue:u(P).value.value,"onUpdate:modelValue":t[4]||(t[4]=e=>u(P).value.value=e),"error-messages":u(P).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),a(O,{class:"d-flex ma-0"},{default:s(()=>[a(H,{class:"d-flex align-self-center ps-0"},{default:s(()=>[a(Y,{label:"預約價格",type:"number",min:"0",modelValue:u(b).value.value,"onUpdate:modelValue":t[5]||(t[5]=e=>u(b).value.value=e),"error-messages":u(b).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(Se,{label:"上架",class:"d-flex justify-center",modelValue:u($).value.value,"onUpdate:modelValue":t[6]||(t[6]=e=>u($).value.value=e),"error-messages":u($).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(Da,{class:"d-flex",inline:"","hide-spin-buttons":"",modelValue:u(h).value.value,"onUpdate:modelValue":t[7]||(t[7]=e=>u(h).value.value=e)},{default:s(()=>[a(be,{class:"d-flex align-center"},{default:s(()=>[J("p",null,[a(Ve,{class:"me-1"},{default:s(()=>[x("mdi-invoice-clock")]),_:1}),x("預約狀態：")])]),_:1}),a(De,{label:"可預約",value:"可預約"}),a(De,{label:"預約已滿",value:"預約已滿"})]),_:1},8,["modelValue"]),u(h).value.value==="可預約"?(M(),Q(be,{key:0,class:"mt-4"},{default:s(()=>[J("p",null,[a(Ve,{class:"me-1"},{default:s(()=>[x("mdi-clock")]),_:1}),x("可預約時段：")]),a(Ee,{"selected-class":"bg-amber-darken-4",multiple:"",modelValue:u(_).value.value,"onUpdate:modelValue":t[8]||(t[8]=e=>u(_).value.value=e),"error-messages":u(_).errorMessage.value},{default:s(()=>[(M(!0),ye(z,null,ke(f.value,e=>(M(),Q(Pe,{key:e,text:e,value:e},null,8,["text","value"]))),128))]),_:1},8,["modelValue","error-messages"])]),_:1})):He("",!0),a(la,{label:"狗狗的性格、特徵",class:"mt-6",modelValue:u(I).value.value,"onUpdate:modelValue":t[9]||(t[9]=e=>u(I).value.value=e),"error-messages":u(I).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(Oe,{class:"justify-center mb-5"},{default:s(()=>[a(X,{class:"bg-red me-5",loading:u(S),onClick:k},{default:s(()=>[x("取消")]),_:1},8,["loading"]),a(X,{class:"bg-green",type:"submit",loading:u(S)},{default:s(()=>[x("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1}),a(O,{class:"justify-center mt-10",width:"1500"},{default:s(()=>[a(le,{flat:""},{default:s(()=>[a(ve,{class:"d-flex align-center pe-2"},{default:s(()=>[Ba,a(ze),a(Y,{label:"搜尋",modelValue:G.value,"onUpdate:modelValue":t[11]||(t[11]=e=>G.value=e),density:"comfortable","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"","onClick:prependInner":t[12]||(t[12]=e=>V(!0)),onKeydown:t[13]||(t[13]=Je(e=>V(!0),["enter"]))},null,8,["modelValue"])]),_:1}),a(Ce),a(Ia,{class:"text-center","items-per-page":j.value,"onUpdate:itemsPerPage":[t[14]||(t[14]=e=>j.value=e),t[17]||(t[17]=e=>V(!1))],"sort-by":F.value,"onUpdate:sortBy":[t[15]||(t[15]=e=>F.value=e),t[18]||(t[18]=e=>V(!1))],page:N.value,"onUpdate:page":[t[16]||(t[16]=e=>N.value=e),t[19]||(t[19]=e=>V(!1))],items:A.value,headers:ae,"items-length":Z.value,loading:E.value,search:G.value},{"item.image":s(({value:e})=>[a(le,{class:"my-2",elevation:"2",rounded:""},{default:s(()=>[a(Ke,{src:e,width:"200",height:"150",cover:""},null,8,["src"])]),_:2},1024)]),"item.booking":s(({value:e})=>[a(Pe,{text:e,color:e==="可預約"?"green":"red",size:"small",label:""},null,8,["text","color"])]),"item.bookingTime":s(({value:e})=>[a(Pa,null,{default:s(()=>[(M(!0),ye(z,null,ke(e.join(" ").split(",").sort((r,i)=>parseInt(r)-parseInt(i)),(r,i)=>(M(),Q(xa,{key:i},{default:s(()=>[x(fe(r),1)]),_:2},1024))),128))]),_:2},1024)]),"item.sell":s(({value:e,item:r})=>[a(Se,{"model-value":e,"onUpdate:modelValue":i=>c(r._id,i)},null,8,["model-value","onUpdate:modelValue"])]),"item.edit":s(({item:e})=>[a(X,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:r=>U(e)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","items-length","loading","search"])]),_:1})]),_:1})]),_:1})}}};typeof xe=="function"&&xe(Ua);export{Ua as default};
