import{p as K,ar as de,q as Z,I as N,s as ee,e as n,k as B,aN as Ke,z as Ze,aR as Ne,K as me,aS as Ge,aT as Je,r as T,aU as ea,aV as re,H as le,O as L,a2 as A,S as se,aW as Ce,X as Me,W as q,L as Ie,aX as aa,P as Te,al as Ae,aq as oe,aY as ta,aZ as na,a_ as pe,F as ve,a$ as la,b0 as ue,b1 as sa,aQ as Oe,_ as oa,u as ra,a as ia,i as da,o as G,j as ce,w as V,d as ge,g as ke,h as $,aH as ua,V as W,a0 as ye,a4 as te,a1 as ca,a5 as Q,a3 as ne,b2 as va,b as ma,a6 as ha,a7 as fa,a8 as $e}from"./index-jtVpxyv_.js";import{_ as pa}from"./dogsCard-CqutBpBS.js";import{c as ga,a as X,d as ka,b as be,u as ya,f as E,V as xe}from"./vee-validate.esm-DcPegmL1.js";import{g as J,b as ba,e as xa,P as Va,N as wa,S as Sa,a as _a}from"./pagination-FwoSSAWW.js";import{V as Ve}from"./VCol-DZWn53cY.js";import{V as Pa}from"./VDivider-Tw89AcUm.js";import{a as Da}from"./VList-D9GBgTjK.js";import{V as Na}from"./VRow-CAX03PjE.js";import{V as Ca}from"./VContainer-tiGqKu1m.js";import{V as Ma}from"./VCheckbox-BSarRBU2.js";import"./VCheckboxBtn-mqD8u8JF.js";const Be=K({active:{type:[String,Array],default:void 0},disabled:{type:[Boolean,String,Array],default:!1},nextIcon:{type:de,default:"$next"},prevIcon:{type:de,default:"$prev"},modeIcon:{type:de,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),we=Z()({name:"VDatePickerControls",props:Be(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(e,a){let{emit:b}=a;const d=N(()=>Array.isArray(e.disabled)?e.disabled.includes("text"):!!e.disabled),t=N(()=>Array.isArray(e.disabled)?e.disabled.includes("mode"):!!e.disabled),v=N(()=>Array.isArray(e.disabled)?e.disabled.includes("prev"):!!e.disabled),i=N(()=>Array.isArray(e.disabled)?e.disabled.includes("next"):!!e.disabled);function u(){b("click:prev")}function o(){b("click:next")}function l(){b("click:year")}function r(){b("click:month")}return ee(()=>n("div",{class:["v-date-picker-controls"]},[n(B,{class:"v-date-picker-controls__month-btn",disabled:d.value,text:e.text,variant:"text",rounded:!0,onClick:r},null),n(B,{key:"mode-btn",class:"v-date-picker-controls__mode-btn",disabled:t.value,density:"comfortable",icon:e.modeIcon,variant:"text",onClick:l},null),n(Ke,{key:"mode-spacer"},null),n("div",{key:"month-buttons",class:"v-date-picker-controls__month"},[n(B,{disabled:v.value,icon:e.prevIcon,variant:"text",onClick:u},null),n(B,{disabled:i.value,icon:e.nextIcon,variant:"text",onClick:o},null)])])),{}}}),Ia=K({appendIcon:String,color:String,header:String,transition:String,onClick:Ge()},"VDatePickerHeader"),Se=Z()({name:"VDatePickerHeader",props:Ia(),emits:{click:()=>!0,"click:append":()=>!0},setup(e,a){let{emit:b,slots:d}=a;const{backgroundColorClasses:t,backgroundColorStyles:v}=Ze(e,"color");function i(){b("click")}function u(){b("click:append")}return ee(()=>{const o=!!(d.default||e.header),l=!!(d.append||e.appendIcon);return n("div",{class:["v-date-picker-header",{"v-date-picker-header--clickable":!!e.onClick},t.value],style:v.value,onClick:i},[d.prepend&&n("div",{key:"prepend",class:"v-date-picker-header__prepend"},[d.prepend()]),o&&n(Ne,{key:"content",name:e.transition},{default:()=>{var r;return[n("div",{key:e.header,class:"v-date-picker-header__content"},[((r=d.default)==null?void 0:r.call(d))??e.header])]}}),l&&n("div",{class:"v-date-picker-header__append"},[d.append?n(me,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VBtn:{icon:e.appendIcon,variant:"text"}}},{default:()=>{var r;return[(r=d.append)==null?void 0:r.call(d)]}}):n(B,{key:"append-btn",icon:e.appendIcon,variant:"text",onClick:u},null)])])}),{}}}),Ye=K({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...Je()},"VDatePickerMonth"),_e=Z()({name:"VDatePickerMonth",props:Ye(),emits:{"update:modelValue":e=>!0,"update:month":e=>!0,"update:year":e=>!0},setup(e,a){let{emit:b,slots:d}=a;const t=T(),{daysInMonth:v,model:i,weekNumbers:u}=ea(e),o=re(),l=le(),r=le(),y=le(!1),w=N(()=>y.value?e.reverseTransition:e.transition);e.multiple==="range"&&i.value.length>0&&(l.value=i.value[0],i.value.length>1&&(r.value=i.value[i.value.length-1]));const m=N(()=>{const h=["number","string"].includes(typeof e.multiple)?Number(e.multiple):1/0;return i.value.length>=h});L(v,(h,s)=>{s&&(y.value=o.isBefore(h[0].date,s[0].date))});function D(h){const s=o.startOfDay(h);if(i.value.length===0?l.value=void 0:i.value.length===1&&(l.value=i.value[0],r.value=void 0),!l.value)l.value=s,i.value=[l.value];else if(r.value)l.value=h,r.value=void 0,i.value=[l.value];else{if(o.isSameDay(s,l.value)){l.value=void 0,i.value=[];return}else o.isBefore(s,l.value)?(r.value=o.endOfDay(l.value),l.value=s):r.value=o.endOfDay(s);const C=o.getDiff(r.value,l.value,"days"),_=[l.value];for(let O=1;O<C;O++){const Y=o.addDays(l.value,O);_.push(Y)}_.push(r.value),i.value=_}}function k(h){const s=i.value.findIndex(C=>o.isSameDay(C,h));if(s===-1)i.value=[...i.value,h];else{const C=[...i.value];C.splice(s,1),i.value=C}}function x(h){e.multiple==="range"?D(h):e.multiple?k(h):i.value=[h]}return()=>n("div",{class:"v-date-picker-month"},[e.showWeek&&n("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!e.hideWeekdays&&n("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[A(" ")]),u.value.map(h=>n("div",{class:["v-date-picker-month__day","v-date-picker-month__day--adjacent"]},[h]))]),n(Ne,{name:w.value},{default:()=>{var h;return[n("div",{ref:t,key:(h=v.value[0].date)==null?void 0:h.toString(),class:"v-date-picker-month__days"},[!e.hideWeekdays&&o.getWeekdays(e.firstDayOfWeek).map(s=>n("div",{class:["v-date-picker-month__day","v-date-picker-month__weekday"]},[s])),v.value.map((s,C)=>{const _={props:{onClick:()=>x(s.date)},item:s,i:C};return m.value&&!s.isSelected&&(s.isDisabled=!0),n("div",{class:["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":s.isAdjacent,"v-date-picker-month__day--hide-adjacent":s.isHidden,"v-date-picker-month__day--selected":s.isSelected,"v-date-picker-month__day--week-end":s.isWeekEnd,"v-date-picker-month__day--week-start":s.isWeekStart}],"data-v-date":s.isDisabled?void 0:s.isoDate},[(e.showAdjacentMonths||!s.isAdjacent)&&n(me,{defaults:{VBtn:{class:"v-date-picker-month__day-btn",color:(s.isSelected||s.isToday)&&!s.isDisabled?e.color:void 0,disabled:s.isDisabled,icon:!0,ripple:!1,text:s.localized,variant:s.isDisabled?s.isToday?"outlined":"text":s.isToday&&!s.isSelected?"outlined":"flat",onClick:()=>x(s.date)}}},{default:()=>{var O;return[((O=d.day)==null?void 0:O.call(d,_))??n(B,_.props,null)]}})])})])]}})])}}),He=K({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number},"VDatePickerMonths"),Pe=Z()({name:"VDatePickerMonths",props:He(),emits:{"update:modelValue":e=>!0},setup(e,a){let{emit:b,slots:d}=a;const t=re(),v=se(e,"modelValue"),i=N(()=>{let u=t.startOfYear(t.date());return e.year&&(u=t.setYear(u,e.year)),Ce(12).map(o=>{const l=t.format(u,"monthShort"),r=!!(e.min&&t.isAfter(t.startOfMonth(t.date(e.min)),u)||e.max&&t.isAfter(u,t.startOfMonth(t.date(e.max))));return u=t.getNextMonth(u),{isDisabled:r,text:l,value:o}})});return Me(()=>{v.value=v.value??t.getMonth(t.date())}),ee(()=>n("div",{class:"v-date-picker-months",style:{height:Ie(e.height)}},[n("div",{class:"v-date-picker-months__content"},[i.value.map((u,o)=>{var y;const l={active:v.value===o,color:v.value===o?e.color:void 0,disabled:u.isDisabled,rounded:!0,text:u.text,variant:v.value===u.value?"flat":"text",onClick:()=>r(o)};function r(w){if(v.value===w){b("update:modelValue",v.value);return}v.value=w}return((y=d.month)==null?void 0:y.call(d,{month:u,i:o,props:l}))??n(B,q({key:"month"},l),null)})])])),{}}}),Ee=K({color:String,height:[String,Number],min:null,max:null,modelValue:Number},"VDatePickerYears"),De=Z()({name:"VDatePickerYears",props:Ee(),emits:{"update:modelValue":e=>!0},setup(e,a){let{emit:b,slots:d}=a;const t=re(),v=se(e,"modelValue"),i=N(()=>{const o=t.getYear(t.date());let l=o-100,r=o+52;e.min&&(l=t.getYear(t.date(e.min))),e.max&&(r=t.getYear(t.date(e.max)));let y=t.startOfYear(t.date());return y=t.setYear(y,l),Ce(r-l+1,l).map(w=>{const m=t.format(y,"year");return y=t.setYear(y,t.getYear(y)+1),{text:m,value:w}})});Me(()=>{v.value=v.value??t.getYear(t.date())});const u=aa();return Te(async()=>{var o;await Ae(),(o=u.el)==null||o.scrollIntoView({block:"center"})}),ee(()=>n("div",{class:"v-date-picker-years",style:{height:Ie(e.height)}},[n("div",{class:"v-date-picker-years__content"},[i.value.map((o,l)=>{var y;const r={ref:v.value===o.value?u:void 0,active:v.value===o.value,color:v.value===o.value?e.color:void 0,rounded:!0,text:o.text,variant:v.value===o.value?"flat":"text",onClick:()=>{if(v.value===o.value){b("update:modelValue",v.value);return}v.value=o.value}};return((y=d.year)==null?void 0:y.call(d,{year:o,i:l,props:r}))??n(B,q({key:"month"},r),null)})])])),{}}}),Ta=K({header:{type:String,default:"$vuetify.datePicker.header"},...Be(),...Ye({weeksInMonth:"static"}),...oe(He(),["modelValue"]),...oe(Ee(),["modelValue"]),...ta({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Aa=Z()({name:"VDatePicker",props:Ta(),emits:{"update:modelValue":e=>!0,"update:month":e=>!0,"update:year":e=>!0,"update:viewMode":e=>!0},setup(e,a){let{emit:b,slots:d}=a;const t=re(),{t:v}=na(),i=se(e,"modelValue",void 0,f=>ue(f),f=>e.multiple?f:f[0]),u=se(e,"viewMode"),o=N(()=>{var I;const f=t.date((I=i.value)==null?void 0:I[0]);return f&&t.isValid(f)?f:t.date()}),l=T(Number(e.month??t.getMonth(t.startOfMonth(o.value)))),r=T(Number(e.year??t.getYear(t.startOfYear(t.setMonth(o.value,l.value))))),y=le(!1),w=N(()=>e.multiple&&i.value.length>1?v("$vuetify.datePicker.itemsSelected",i.value.length):i.value[0]&&t.isValid(i.value[0])?t.format(t.date(i.value[0]),"normalDateWithWeekday"):v(e.header)),m=N(()=>{let f=t.date();return f=t.setDate(f,1),f=t.setMonth(f,l.value),f=t.setYear(f,r.value),t.format(f,"monthAndYear")}),D=N(()=>`date-picker-header${y.value?"-reverse":""}-transition`),k=N(()=>{const f=t.date(e.min);return e.min&&t.isValid(f)?f:null}),x=N(()=>{const f=t.date(e.max);return e.max&&t.isValid(f)?f:null}),h=N(()=>{if(e.disabled)return!0;const f=[];if(u.value!=="month")f.push("prev","next");else{let I=t.date();if(I=t.setYear(I,r.value),I=t.setMonth(I,l.value),k.value){const M=t.addDays(t.startOfMonth(I),-1);t.isAfter(k.value,M)&&f.push("prev")}if(x.value){const M=t.addDays(t.endOfMonth(I),1);t.isAfter(M,x.value)&&f.push("next")}}return f});function s(){l.value<11?l.value++:(r.value++,l.value=0,F(r.value)),j(l.value)}function C(){l.value>0?l.value--:(r.value--,l.value=11,F(r.value)),j(l.value)}function _(){u.value="month"}function O(){u.value=u.value==="months"?"month":"months"}function Y(){u.value=u.value==="year"?"month":"year"}function j(f){u.value==="months"&&O(),b("update:month",f)}function F(f){u.value==="year"&&Y(),b("update:year",f)}return L(i,(f,I)=>{const M=ue(I),H=ue(f);if(!H.length)return;const R=t.date(M[M.length-1]),z=t.date(H[H.length-1]),U=t.getMonth(z),P=t.getYear(z);U!==l.value&&(l.value=U,j(l.value)),P!==r.value&&(r.value=P,F(r.value)),y.value=t.isBefore(R,z)}),ee(()=>{const f=pe.filterProps(e),I=we.filterProps(e),M=Se.filterProps(e),H=_e.filterProps(e),R=oe(Pe.filterProps(e),["modelValue"]),z=oe(De.filterProps(e),["modelValue"]),U={header:w.value,transition:D.value};return n(pe,q(f,{class:["v-date-picker",`v-date-picker--${u.value}`,{"v-date-picker--show-week":e.showWeek},e.class],style:e.style}),{title:()=>{var P;return((P=d.title)==null?void 0:P.call(d))??n("div",{class:"v-date-picker__title"},[v(e.title)])},header:()=>d.header?n(me,{defaults:{VDatePickerHeader:{...U}}},{default:()=>{var P;return[(P=d.header)==null?void 0:P.call(d,U)]}}):n(Se,q({key:"header"},M,U,{onClick:u.value!=="month"?_:void 0}),{...d,default:void 0}),default:()=>n(ve,null,[n(we,q(I,{disabled:h.value,text:m.value,"onClick:next":s,"onClick:prev":C,"onClick:month":O,"onClick:year":Y}),null),n(la,{hideOnLeave:!0},{default:()=>[u.value==="months"?n(Pe,q({key:"date-picker-months"},R,{modelValue:l.value,"onUpdate:modelValue":[P=>l.value=P,j],min:k.value,max:x.value,year:r.value}),null):u.value==="year"?n(De,q({key:"date-picker-years"},z,{modelValue:r.value,"onUpdate:modelValue":[P=>r.value=P,F],min:k.value,max:x.value}),null):n(_e,q({key:"date-picker-month"},H,{modelValue:i.value,"onUpdate:modelValue":P=>i.value=P,month:l.value,"onUpdate:month":[P=>l.value=P,j],year:r.value,"onUpdate:year":[P=>r.value=P,F],min:k.value,max:x.value}),null)]})]),actions:d.actions})}),{}}});function Oa(e){let{swiper:a,extendParams:b,on:d}=e;b({history:{enabled:!1,root:"",replaceState:!1,key:"slides",keepQuery:!1}});let t=!1,v={};const i=m=>m.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""),u=m=>{const D=J();let k;m?k=new URL(m):k=D.location;const x=k.pathname.slice(1).split("/").filter(_=>_!==""),h=x.length,s=x[h-2],C=x[h-1];return{key:s,value:C}},o=(m,D)=>{const k=J();if(!t||!a.params.history.enabled)return;let x;a.params.url?x=new URL(a.params.url):x=k.location;const h=a.virtual&&a.params.virtual.enabled?a.slidesEl.querySelector(`[data-swiper-slide-index="${D}"]`):a.slides[D];let s=i(h.getAttribute("data-history"));if(a.params.history.root.length>0){let _=a.params.history.root;_[_.length-1]==="/"&&(_=_.slice(0,_.length-1)),s=`${_}/${m?`${m}/`:""}${s}`}else x.pathname.includes(m)||(s=`${m?`${m}/`:""}${s}`);a.params.history.keepQuery&&(s+=x.search);const C=k.history.state;C&&C.value===s||(a.params.history.replaceState?k.history.replaceState({value:s},null,s):k.history.pushState({value:s},null,s))},l=(m,D,k)=>{if(D)for(let x=0,h=a.slides.length;x<h;x+=1){const s=a.slides[x];if(i(s.getAttribute("data-history"))===D){const _=a.getSlideIndex(s);a.slideTo(_,m,k)}}else a.slideTo(0,m,k)},r=()=>{v=u(a.params.url),l(a.params.speed,v.value,!1)},y=()=>{const m=J();if(a.params.history){if(!m.history||!m.history.pushState){a.params.history.enabled=!1,a.params.hashNavigation.enabled=!0;return}if(t=!0,v=u(a.params.url),!v.key&&!v.value){a.params.history.replaceState||m.addEventListener("popstate",r);return}l(0,v.value,a.params.runCallbacksOnInit),a.params.history.replaceState||m.addEventListener("popstate",r)}},w=()=>{const m=J();a.params.history.replaceState||m.removeEventListener("popstate",r)};d("init",()=>{a.params.history.enabled&&y()}),d("destroy",()=>{a.params.history.enabled&&w()}),d("transitionEnd _freeModeNoMomentumRelease",()=>{t&&o(a.params.history.key,a.activeIndex)}),d("slideChange",()=>{t&&a.params.cssMode&&o(a.params.history.key,a.activeIndex)})}function $a(e){let{swiper:a,extendParams:b,emit:d,on:t}=e,v=!1;const i=ba(),u=J();b({hashNavigation:{enabled:!1,replaceState:!1,watchState:!1,getSlideIndex(w,m){if(a.virtual&&a.params.virtual.enabled){const D=a.slides.filter(x=>x.getAttribute("data-hash")===m)[0];return D?parseInt(D.getAttribute("data-swiper-slide-index"),10):0}return a.getSlideIndex(xa(a.slidesEl,`.${a.params.slideClass}[data-hash="${m}"], swiper-slide[data-hash="${m}"]`)[0])}}});const o=()=>{d("hashChange");const w=i.location.hash.replace("#",""),m=a.virtual&&a.params.virtual.enabled?a.slidesEl.querySelector(`[data-swiper-slide-index="${a.activeIndex}"]`):a.slides[a.activeIndex],D=m?m.getAttribute("data-hash"):"";if(w!==D){const k=a.params.hashNavigation.getSlideIndex(a,w);if(typeof k>"u"||Number.isNaN(k))return;a.slideTo(k)}},l=()=>{if(!v||!a.params.hashNavigation.enabled)return;const w=a.virtual&&a.params.virtual.enabled?a.slidesEl.querySelector(`[data-swiper-slide-index="${a.activeIndex}"]`):a.slides[a.activeIndex],m=w?w.getAttribute("data-hash")||w.getAttribute("data-history"):"";a.params.hashNavigation.replaceState&&u.history&&u.history.replaceState?(u.history.replaceState(null,null,`#${m}`||""),d("hashSet")):(i.location.hash=m||"",d("hashSet"))},r=()=>{if(!a.params.hashNavigation.enabled||a.params.history&&a.params.history.enabled)return;v=!0;const w=i.location.hash.replace("#","");if(w){const D=a.params.hashNavigation.getSlideIndex(a,w);a.slideTo(D||0,0,a.params.runCallbacksOnInit,!0)}a.params.hashNavigation.watchState&&u.addEventListener("hashchange",o)},y=()=>{a.params.hashNavigation.watchState&&u.removeEventListener("hashchange",o)};t("init",()=>{a.params.hashNavigation.enabled&&r()}),t("destroy",()=>{a.params.hashNavigation.enabled&&y()}),t("transitionEnd _freeModeNoMomentumRelease",()=>{v&&l()}),t("slideChange",()=>{v&&a.params.cssMode&&l()})}const Ba=sa("BookingOrderData",()=>{const{apiAuth:e}=Oe(),a=T(new Date().toLocaleDateString().replace(/\//g,""));console.log("nowDate:",a.value);const b=T(null),d=T(""),t=T(""),v=T(""),i=async()=>{var u,o;try{console.log("Store觸發");const{data:l}=await e.get("/order",{params:{search:a.value}});b.value=Math.max(...l.result.data.map(r=>Number(r.bookingOrderNumber)))}catch(l){console.log(l),createSnackbar({text:((o=(u=l==null?void 0:l.response)==null?void 0:u.data)==null?void 0:o.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return i(),{bookingOrderNumber:b,dogName:d,bookingDate:t,bookingTime:v,endBookingOrderData:i}}),qe=e=>(ha("data-v-37ef42b4"),e=e(),fa(),e),Ya=qe(()=>$e("h1",null,"預約狗狗時間",-1)),Ha=qe(()=>$e("h3",null,"可預約時段",-1)),Ea={__name:"booking",setup(e){const a=va(),b=ma(),{mobile:d}=ra(),{backApi:t,apiAuth:v}=Oe(),i=ia(),u=Ba(),o=da(),l=[Va,wa,$a,Oa],r=N(()=>{if(!i.isLogin){b.push("/login");return}return i.account}),y=T(new Date("")),w=T(new Date),m=N(()=>isNaN(y.value.getTime())?"左側選擇日期":y.value.toLocaleDateString()),D=g=>g>w.value,k=T([]);(async()=>{var g,p;try{const{data:c}=await t.get("/dogs");k.value.splice(0,k.value.length,...c.result.data)}catch(c){console.log(c),o({text:((p=(g=c==null?void 0:c.response)==null?void 0:g.data)==null?void 0:p.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const h=T({_id:"",image:"",dogName:"",age:0,price:0,booking:!0,bookingTime:[],feature:"",sell:!0,counter:0}),s=T(null);L(s,(g,p)=>{if(g!==p)return M.value=[];console.log("哈希newId:",g,"哈希oldId:",p)});const C=()=>{a.query.id?(s.value=a.query.id,window.location.hash=`booking#${a.query.id}`,a.query.id=""):s.value=window.location.hash.substring(10)},_=()=>{C(),O()};Te(()=>{setTimeout(()=>{C(),O()},500)});const O=async()=>{var g,p;if(s.value!==null)try{await Ae();const{data:c}=await t.get("/dogs/"+s.value);h.value._id=c.result._id,h.value.image=c.result.image,h.value.dogName=c.result.dogName,h.value.age=c.result.age,h.value.price=c.result.price,h.value.booking=c.result.booking,h.value.bookingTime=c.result.bookingTime,h.value.feature=c.result.feature,h.value.sell=c.result.sell,h.value.counter=c.result.counter}catch(c){console.log(c),o({text:((p=(g=c==null?void 0:c.response)==null?void 0:g.data)==null?void 0:p.message)||"發生錯誤",snackbarProps:{color:"red"}})}};O();const Y=T(!1),j=g=>{g.target.innerText==m.value.slice(-2).replace("/","")&&(Y.value=!0)},F=()=>{Y.value=!1},f=T(!1),I=()=>{f.value=!f.value},M=T([]),H=N(()=>M.value.length*2),R=N(()=>h.value.price*M.value.length),z=ga({bookingOrderNumber:X().required("預約訂單編號必填"),name:X().required("預約人名字必填"),phone:X().required("預約人電話必填"),dogName:X().required("狗狗名字必填"),bookingDate:X().required("預約日期必填"),bookingTime:ka().required("預約時段必填"),totalBookingTime:be().required("預約總時數必填").typeError("預約總時數格式錯誤").min(0,"預約總時數不能小於 0"),totalPrice:be().required("預約總金額必填").typeError("預約總金額格式錯誤").min(0,"預約總金額不能小於 0"),accountName:X().required("帳戶名稱必填")}),{handleSubmit:U,isSubmitting:P,resetForm:Re}=ya({validationSchema:z,initialValues:{bookingOrderNumber:"",name:r.value,phone:"",dogName:"",bookingDate:"",bookingTime:[],totalBookingTime:0,totalPrice:0,accountName:""}}),he=E("bookingOrderNumber"),ae=E("name"),ie=E("phone"),Ue=E("dogName"),We=E("bookingDate"),Le=E("bookingTime"),je=E("totalBookingTime"),Fe=E("totalPrice"),ze=E("accountName");L(m,(g,p)=>{if(g!==p)return ze.value.value=r.value,Ue.value.value=h.value.dogName});const Qe=async()=>{await u.endBookingOrderData()};L(m,(g,p)=>{if(g!==p)return M.value=[],We.value.value=m.value,Qe(),he.value.value=(u.bookingOrderNumber+1).toString(),console.log("bookingOrderNumber",he.value.value)}),L(M,(g,p)=>{if(g!==p)return Le.value.value=M.value.sort((c,S)=>parseInt(c)-parseInt(S))}),L(H,(g,p)=>{if(g!==p)return je.value.value=H.value}),L(R,(g,p)=>{if(g!==p)return Fe.value.value=R.value});const Xe=U(async g=>{var p,c;try{const S=new FormData;S.append("bookingOrderNumber",g.bookingOrderNumber),S.append("name",g.name),S.append("phone",g.phone),S.append("dogName",g.dogName),S.append("bookingDate",g.bookingDate),S.append("bookingTime",g.bookingTime),S.append("totalBookingTime",g.totalBookingTime),S.append("totalPrice",g.totalPrice),S.append("accountName",g.accountName),await v.post("/order",S),o({text:"預約成功",snackbarProps:{color:"green"}}),Re(),m.value=NaN,M.value=[],R.value=0}catch(S){console.log(S),o({text:((c=(p=S==null?void 0:S.response)==null?void 0:p.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),fe=N(()=>({myClass:ae.value.value.length>0}));return(g,p)=>(G(),ce(Ca,{class:"text-center mt-8"},{default:V(()=>[Ya,n($(Sa),{slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,pagination:{clickable:!0},navigation:!0,hashNavigation:{replaceState:!0,watchState:!0},modules:l,onSlideChangeTransitionEnd:_,class:"mySwiper my-10"},{default:V(()=>[(G(!0),ge(ve,null,ke(k.value,c=>(G(),ce($(_a),{"data-hash":`/booking#${c._id}`},{default:V(()=>[n(W,{style:{width:"100%"}},{default:V(()=>[n(pa,q({ref_for:!0},c),null,16)]),_:2},1024)]),_:2},1032,["data-hash"]))),256))]),_:1}),n(Na,{class:"my-7"},{default:V(()=>[n(Ve,{class:"d-flex flex-wrap justify-center",cols:"12",sm:"6"},{default:V(()=>[n(Aa,{width:"400",color:"primary",modelValue:y.value,"onUpdate:modelValue":p[0]||(p[0]=c=>y.value=c),"show-adjacent-months":"","allowed-dates":D,onClick:p[1]||(p[1]=c=>j(c))},null,8,["modelValue"]),n(ua,{modelValue:Y.value,"onUpdate:modelValue":p[3]||(p[3]=c=>Y.value=c)},{default:V(()=>[n(xe,null,{default:V(()=>[n(W,{class:"bg-white d-flex flex-column text-center justify-self-center align-self-center pa-7",width:"350",height:"240"},{default:V(()=>[Ha,n(Pa,{class:"my-4"}),(G(!0),ge(ve,null,ke(h.value.bookingTime.join(" ").split(",").sort((c,S)=>parseInt(c)-parseInt(S)),c=>(G(),ce(Ma,{class:"d-flex justify-center",modelValue:M.value,"onUpdate:modelValue":p[2]||(p[2]=S=>M.value=S),label:c,value:c,"false-icon":"mdi-paw-outline","true-icon":"mdi-paw"},null,8,["modelValue","label","value"]))),256)),n(W,{class:"dialogClosePosition rounded-circle bg-transparent d-flex"},{default:V(()=>[n(B,{class:"rounded-circle d-flex pa-0 bg-white opacity-100","min-width":"60","min-height":"60",variant:"plain",onClick:F,flat:""},{default:V(()=>[n(ye,{icon:f.value?"mdi-close-circle":"mdi-close-circle-outline",size:`48
                  `,color:"red-darken-4",onMouseenter:I,onMouseleave:I},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(W,{class:te(["bg-transparent d-flex align-center",$(d)?"mt-5":""])},{default:V(()=>[n(ye,{icon:"mdi-message-alert",class:"me-1",color:"orange-darken-2"}),A("當天日期無法預約，若有需求，請來電洽詢，謝謝！")]),_:1},8,["class"])]),_:1}),n(Ve,{class:te(["d-flex justify-center",$(d)?"my-4":""])},{default:V(()=>[n(xe,{class:"w-90",cols:"12",sm:"6",onSubmit:ca($(Xe),["prevent"]),disabled:$(P)},{default:V(()=>[n(Q,{label:"預約人姓名",class:te(fe.value),modelValue:$(ae).value.value,"onUpdate:modelValue":p[4]||(p[4]=c=>$(ae).value.value=c),"error-messages":$(ae).errorMessage.value},null,8,["class","modelValue","error-messages"]),n(Q,{label:"預約人電話",class:te(fe.value),modelValue:$(ie).value.value,"onUpdate:modelValue":p[5]||(p[5]=c=>$(ie).value.value=c),"error-messages":$(ie).errorMessage.value},null,8,["class","modelValue","error-messages"]),n(Q,{readonly:""},{default:V(()=>[A("預約狗狗： "),n(W,{class:"text-h6 font-weight-bold bg-transparent"},{default:V(()=>[A(ne(h.value.dogName),1)]),_:1})]),_:1}),n(Q,{readonly:""},{default:V(()=>[A("預約日期： "),n(W,{class:"text-h6 font-weight-bold bg-transparent"},{default:V(()=>[A(ne(m.value),1)]),_:1})]),_:1}),n(Q,{readonly:""},{default:V(()=>[A("預約時間： "),n(Da,{class:"my-0 pa-0 bg-transparent",items:M.value.sort((c,S)=>parseInt(c)-parseInt(S))},null,8,["items"])]),_:1}),n(Q,{readonly:""},{default:V(()=>[A("預約總時數： "),n(W,{class:"text-h5 font-weight-bold bg-transparent"},{default:V(()=>[A(ne(H.value),1)]),_:1}),A(" 小時 ")]),_:1}),n(Q,{readonly:""},{default:V(()=>[A("總計金額： "),n(W,{class:"text-h5 font-weight-bold bg-transparent"},{default:V(()=>[A(ne(R.value),1)]),_:1}),A(" 元 ")]),_:1}),n(B,{class:"w-40 mt-5",type:"submit",color:"green",loading:$(P)},{default:V(()=>[A("送出預約")]),_:1},8,["loading"])]),_:1},8,["onSubmit","disabled"])]),_:1},8,["class"])]),_:1})]),_:1}))}},Za=oa(Ea,[["__scopeId","data-v-37ef42b4"]]);export{Za as default};
